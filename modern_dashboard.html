<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TalentScope - Tableau de Bord</title>
    <link rel="icon" type="image/png" href="Logos/TalentScope.png">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/js/all.min.js"></script>
    <link rel="stylesheet" href="themes.css">
    <link rel="stylesheet" href="professional-icons.css">
    
    <!-- SCRIPT DE NAVIGATION IMM√âDIAT -->
    <script>
        // Fonction de navigation disponible imm√©diatement
        window.showSection = function(sectionName) {
            console.log('üîÑ Navigation vers:', sectionName);
            
            // Cacher toutes les sections
            const sections = document.querySelectorAll('.content-section');
            sections.forEach(section => {
                section.style.display = 'none';
            });

            // Afficher la section demand√©e
            const targetSection = document.getElementById(sectionName + '-section');
            if (targetSection) {
                targetSection.style.display = 'block';
                console.log('‚úÖ Section affich√©e:', sectionName);
            } else {
                console.log('‚ùå Section non trouv√©e:', sectionName);
            }
            
            // Mettre √† jour la navigation active
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            const activeItem = document.querySelector(`[onclick*="${sectionName}"]`);
            if (activeItem) {
                activeItem.classList.add('active');
            }
        };
        
        console.log('‚úÖ Fonction showSection charg√©e dans le HEAD');
    </script>
    <script src="user_database.js"></script>
    <script src="direct-translation.js"></script>
    <script src="icon-replacer.js"></script>
    <script src="debug_translation.js"></script>
    <style>
        /* Variables CSS pour le th√®me */
        :root {
            /* Th√®me clair optimis√© */
            --primary-color: #6366f1;
            --secondary-color: #8b5cf6;
            --accent-color: #ec4899;
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --error-color: #ef4444;
            --info-color: #3b82f6;
            
            /* Couleurs de fond */
            --bg-primary: #ffffff;
            --bg-secondary: #f8fafc;
            --bg-tertiary: #f1f5f9;
            --bg-glass: rgba(255, 255, 255, 0.9);
            
            /* Couleurs de texte */
            --text-primary: #0f172a;
            --text-secondary: #475569;
            --text-muted: #64748b;
            --text-inverse: #ffffff;
            
            /* Bordures */
            --border-primary: #e2e8f0;
            --border-secondary: #cbd5e1;
            --border-focus: #6366f1;
            
            /* Ombres */
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            
            /* Effets */
            --backdrop-blur: blur(12px);
            --transition-fast: 0.15s ease;
            --transition-normal: 0.3s ease;
            --transition-slow: 0.5s ease;
        }

        /* Th√®me sombre optimis√© pour la lisibilit√© */
        [data-theme="dark"] {
            --primary-color: #8b5cf6;
            --secondary-color: #a855f7;
            --accent-color: #ec4899;
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --error-color: #ef4444;
            --info-color: #3b82f6;
            
            /* Arri√®re-plans plus clairs pour la lisibilit√© */
            --bg-primary: #1a1a2e;
            --bg-secondary: #16213e;
            --bg-tertiary: #0f3460;
            --bg-glass: rgba(26, 26, 46, 0.95);
            
            /* Texte avec contraste √©lev√© */
            --text-primary: #ffffff;
            --text-secondary: #f1f5f9;
            --text-muted: #cbd5e1;
            --text-inverse: #1a1a2e;
            
            /* Bordures plus visibles */
            --border-primary: #374151;
            --border-secondary: #4b5563;
            --border-focus: #8b5cf6;
            
            /* Ombres plus prononc√©es */
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.6);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.7), 0 2px 4px -1px rgba(0, 0, 0, 0.6);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.7), 0 4px 6px -2px rgba(0, 0, 0, 0.6);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.8), 0 10px 10px -5px rgba(0, 0, 0, 0.5);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        /* Animations pour le changement de th√®me */
        * {
            transition: background-color var(--transition-normal), 
                       color var(--transition-normal), 
                       border-color var(--transition-normal),
                       box-shadow var(--transition-normal);
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            min-height: 100vh;
            display: flex;
            color: var(--text-primary);
            transition: background var(--transition-slow), color var(--transition-slow);
        }

        /* Sidebar */
        .sidebar {
            width: 280px;
            background: var(--bg-glass);
            backdrop-filter: var(--backdrop-blur);
            border-radius: 0 20px 20px 0;
            padding: 30px 20px;
            box-shadow: var(--shadow-xl);
            border: 1px solid var(--border-primary);
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            transition: all var(--transition-slow);
        }

        .logo {
            text-align: center;
            margin-bottom: 40px;
        }

        .logo h1 {
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .logo p {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .nav-section {
            margin-bottom: 30px;
        }

        .nav-title {
            color: var(--text-primary);
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .nav-item {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            margin-bottom: 8px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            color: var(--text-secondary);
            text-decoration: none;
            gap: 45px;
        }

        .nav-item:hover {
            background: rgba(102, 126, 234, 0.1);
            color: var(--primary-color);
            transform: translateX(5px);
        }

        .nav-item.active {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .nav-item i {
            font-size: 1.2rem;
            width: 24px;
            text-align: center;
            min-width: 24px;
            display: inline-flex;
            justify-content: center;
            align-items: center;
        }

        .nav-item span {
            font-weight: 500;
        }

        .nav-item .subtitle {
            font-size: 0.8rem;
            opacity: 0.8;
            margin-top: 2px;
        }

        .user-info {
            position: absolute;
            bottom: 30px;
            left: 20px;
            right: 20px;
            padding: 0;
        }

        .user-profile-card {
            background: linear-gradient(135deg, var(--bg-glass), rgba(255, 255, 255, 0.1));
            border: 1px solid var(--border-primary);
            border-radius: 16px;
            padding: 16px;
            display: flex;
            align-items: center;
            gap: 12px;
            transition: all var(--transition-normal);
            backdrop-filter: var(--backdrop-blur);
            min-height: 70px;
            position: relative;
            overflow: hidden;
            box-shadow: var(--shadow-lg);
        }

        .user-profile-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.05), rgba(139, 92, 246, 0.05));
            opacity: 0;
            transition: opacity var(--transition-normal);
            z-index: 0;
        }

        .user-profile-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-xl);
            border-color: var(--primary-color);
        }

        .user-profile-card:hover::before {
            opacity: 1;
        }

        .user-profile-card > * {
            position: relative;
            z-index: 1;
        }

        .profile-photo {
            flex-shrink: 0;
        }

        .profile-avatar {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid var(--border-primary);
            transition: all var(--transition-normal);
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            font-size: 1.3rem;
            overflow: hidden;
            position: relative;
            box-shadow: var(--shadow-md);
        }

        .profile-avatar::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            border-radius: 50%;
            z-index: -1;
            opacity: 0;
            transition: opacity var(--transition-normal);
        }

        .profile-avatar:hover {
            transform: scale(1.05);
            border-color: var(--primary-color);
        }

        .profile-avatar:hover::before {
            opacity: 1;
        }

        /* Indicateur de statut sur l'avatar */
        .status-indicator {
            position: absolute;
            bottom: 2px;
            right: 2px;
            width: 12px;
            height: 12px;
            background: #10b981;
            border: 2px solid white;
            border-radius: 50%;
            z-index: 2;
        }

        /* Statut en ligne */
        .profile-status {
            display: flex;
            align-items: center;
            gap: 6px;
            margin-top: 2px;
        }

        .status-dot {
            width: 6px;
            height: 6px;
            background: #10b981;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        .status-text {
            font-size: 0.7rem;
            color: var(--text-muted);
            font-weight: 500;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        .profile-avatar img {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            object-fit: cover;
        }

        .profile-avatar:hover {
            border-color: var(--primary-color);
            transform: scale(1.05);
        }

        .profile-info {
            flex: 1;
            min-width: 0;
        }

        .profile-name {
            font-weight: 600;
            color: var(--text-primary);
            font-size: 0.7rem;
            margin-bottom: 1px;
            margin-top: -3px;
            white-space: nowrap;
            overflow: visible;
            text-overflow: unset;
            max-width: none;
            width: 100%;
            line-height: 1.1;
            letter-spacing: -0.02em;
        }

        .profile-role {
            font-size: 0.65rem;
            color: var(--text-secondary);
            white-space: nowrap;
            overflow: visible;
            text-overflow: unset;
            max-width: none;
            width: 100%;
            line-height: 1.1;
            letter-spacing: -0.01em;
        }

        .profile-actions {
            flex-shrink: 0;
            position: relative;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .profile-btn {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-primary);
            color: var(--text-secondary);
            font-size: 1.1rem;
            cursor: pointer;
            padding: 8px;
            border-radius: 12px;
            transition: all var(--transition-normal);
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            min-width: 40px;
            min-height: 40px;
            box-shadow: var(--shadow-sm);
        }

        .logout-btn {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            border: 1px solid #dc2626;
            color: white;
            font-size: 1.1rem;
            cursor: pointer;
            padding: 8px;
            border-radius: 12px;
            transition: all var(--transition-normal);
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            min-width: 40px;
            min-height: 40px;
            box-shadow: var(--shadow-sm);
        }

        .profile-btn:hover {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            transform: translateY(-2px) scale(1.05);
            box-shadow: var(--shadow-lg);
            border-color: var(--primary-color);
        }

        .logout-btn:hover {
            background: linear-gradient(135deg, #dc2626, #b91c1c);
            color: white;
            transform: translateY(-2px) scale(1.05);
            box-shadow: var(--shadow-lg);
            border-color: #b91c1c;
        }

        /* Styles pour les badges de statut */
        .status-badge {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .status-badge.excellent {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
        }

        .status-badge.very-good {
            background: linear-gradient(135deg, #3b82f6, #2563eb);
            color: white;
        }

        .status-badge.good {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
        }

        .status-badge.average {
            background: linear-gradient(135deg, #f97316, #ea580c);
            color: white;
        }

        .status-badge.poor {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            color: white;
        }


        /* Animation pour le changement de th√®me */
        @keyframes themeTransition {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }

        .theme-transitioning {
            animation: themeTransition 0.5s ease-in-out;
        }

        /* Am√©liorations sp√©cifiques pour le mode sombre */
        [data-theme="dark"] .sidebar {
            background: var(--bg-glass);
            border-right: 1px solid var(--border-primary);
        }

        [data-theme="dark"] .metric-card {
            background: var(--bg-glass);
            border: 1px solid var(--border-primary);
            color: var(--text-primary);
        }

        [data-theme="dark"] .metric-card .metric-value {
            color: var(--text-primary);
            font-weight: 700;
        }

        [data-theme="dark"] .metric-card .metric-label {
            color: var(--text-secondary);
        }

        [data-theme="dark"] .metric-card .metric-trend {
            color: var(--text-muted);
        }

        [data-theme="dark"] .section-title {
            color: var(--text-primary);
        }

        [data-theme="dark"] .dashboard-title {
            color: var(--text-primary);
        }

        [data-theme="dark"] .dashboard-subtitle {
            color: var(--text-secondary);
        }

        [data-theme="dark"] .nav-item {
            color: var(--text-secondary);
        }

        [data-theme="dark"] .nav-item:hover {
            color: var(--text-primary);
            background: var(--bg-tertiary);
        }

        [data-theme="dark"] .nav-item.active {
            color: var(--text-primary);
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
        }

        [data-theme="dark"] .nav-item.active .nav-icon {
            color: white;
        }

        [data-theme="dark"] .nav-item.active .nav-text {
            color: white;
        }

        [data-theme="dark"] .nav-item.active .subtitle {
            color: rgba(255, 255, 255, 0.8);
        }

        /* Am√©lioration des cartes de configuration */
        [data-theme="dark"] .config-card {
            background: var(--bg-glass);
            border: 1px solid var(--border-primary);
            color: var(--text-primary);
        }

        [data-theme="dark"] .config-header h4 {
            color: var(--text-primary);
        }

        [data-theme="dark"] .config-description {
            color: var(--text-secondary);
        }

        /* Am√©lioration des boutons de th√®me */
        [data-theme="dark"] .theme-option {
            color: var(--text-secondary);
        }

        [data-theme="dark"] .theme-option:hover {
            color: var(--text-primary);
            background: var(--bg-tertiary);
        }

        [data-theme="dark"] .theme-option.active {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
        }

        /* Am√©lioration des tableaux */
        [data-theme="dark"] .analysis-table {
            background: var(--bg-glass);
            border: 1px solid var(--border-primary);
        }

        [data-theme="dark"] .analysis-table th {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border-bottom: 1px solid var(--border-primary);
        }

        [data-theme="dark"] .analysis-table td {
            color: var(--text-primary);
            border-bottom: 1px solid var(--border-primary);
        }

        [data-theme="dark"] .analysis-table tr:hover {
            background: var(--bg-tertiary);
        }

        /* Am√©lioration des formulaires */
        [data-theme="dark"] .form-control {
            background: var(--bg-secondary);
            border: 1px solid var(--border-primary);
            color: var(--text-primary);
        }

        [data-theme="dark"] .form-control:focus {
            border-color: var(--primary-color);
            background: var(--bg-tertiary);
        }

        [data-theme="dark"] .form-control::placeholder {
            color: var(--text-muted);
        }

        /* Am√©lioration des boutons */
        [data-theme="dark"] .btn {
            color: var(--text-primary);
        }

        [data-theme="dark"] .btn-outline {
            border-color: var(--border-primary);
            color: var(--text-primary);
        }

        [data-theme="dark"] .btn-outline:hover {
            background: var(--primary-color);
            color: white;
        }

        /* Am√©lioration sp√©cifique de la section profil en mode sombre */
        [data-theme="dark"] .user-profile-card {
            background: linear-gradient(135deg, var(--bg-glass), rgba(26, 26, 46, 0.1));
            border: 1px solid var(--border-primary);
        }

        [data-theme="dark"] .user-profile-card::before {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.1), rgba(168, 85, 247, 0.1));
        }

        [data-theme="dark"] .user-profile-card:hover {
            border-color: var(--primary-color);
        }

        [data-theme="dark"] .profile-name {
            color: var(--text-primary);
            font-weight: 700;
        }

        [data-theme="dark"] .profile-role {
            color: var(--text-secondary);
        }

        [data-theme="dark"] .status-text {
            color: var(--text-muted);
        }

        [data-theme="dark"] .profile-btn {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-primary);
            color: var(--text-secondary);
        }

        [data-theme="dark"] .profile-btn:hover {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border-color: var(--primary-color);
        }

        [data-theme="dark"] .logout-btn {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            border: 1px solid #dc2626;
            color: white;
        }

        [data-theme="dark"] .logout-btn:hover {
            background: linear-gradient(135deg, #dc2626, #b91c1c);
            border-color: #b91c1c;
        }

        [data-theme="dark"] .dropdown-menu {
            background: var(--bg-glass);
            border: 1px solid var(--border-primary);
        }

        [data-theme="dark"] .dropdown-item {
            color: var(--text-primary);
        }

        [data-theme="dark"] .dropdown-item:hover {
            background: var(--bg-tertiary);
            color: var(--primary-color);
        }

        /* Am√©lioration des logos et textes de navigation */
        [data-theme="dark"] .logo h1 {
            color: var(--text-primary);
        }

        [data-theme="dark"] .logo p {
            color: var(--text-secondary);
        }

        [data-theme="dark"] .nav-section-title {
            color: var(--text-muted);
        }

        /* Am√©lioration des graphiques et m√©triques */
        [data-theme="dark"] .chart-container {
            background: var(--bg-glass);
            border: 1px solid var(--border-primary);
        }

        [data-theme="dark"] .metric-header {
            color: var(--text-primary);
        }

        [data-theme="dark"] .metric-icon {
            color: var(--primary-color);
        }

        /* Styles pour les cartes de configuration */
        .config-card {
            background: var(--bg-glass);
            backdrop-filter: var(--backdrop-blur);
            border: 1px solid var(--border-primary);
            border-radius: 16px;
            padding: 24px;
            box-shadow: var(--shadow-lg);
            transition: all var(--transition-normal);
        }

        .config-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-xl);
        }

        .config-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 12px;
        }

        .config-header i {
            font-size: 1.2rem;
            color: var(--primary-color);
        }

        .config-header h4 {
            color: var(--text-primary);
            font-size: 1.1rem;
            font-weight: 600;
            margin: 0;
        }

        .config-description {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-bottom: 20px;
            line-height: 1.5;
        }

        /* S√©lecteur de th√®me √©l√©gant */
        .theme-selector {
            display: flex;
            gap: 12px;
            background: var(--bg-secondary);
            padding: 6px;
            border-radius: 12px;
            border: 1px solid var(--border-primary);
        }

        .theme-option {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 12px 16px;
            border: none;
            border-radius: 8px;
            background: transparent;
            color: var(--text-secondary);
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            transition: all var(--transition-normal);
            position: relative;
            overflow: hidden;
        }

        .theme-option:hover {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            transform: translateY(-1px);
        }

        .theme-option.active {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            box-shadow: var(--shadow-md);
            transform: translateY(-1px);
        }

        .theme-option.active::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(255,255,255,0.1), rgba(255,255,255,0.05));
            border-radius: 8px;
        }

        .theme-option i {
            font-size: 1rem;
            transition: all var(--transition-normal);
        }

        .theme-option.active i {
            transform: scale(1.1);
        }

        /* Optimisation sp√©cifique pour la sidebar */
        .user-profile-card .profile-avatar {
            width: 36px !important;
            height: 36px !important;
            font-size: 1.1rem !important;
        }

        .user-profile-card .profile-info {
            flex: 1;
            min-width: 0;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .user-profile-card .profile-name {
            font-size: 1rem;
            font-weight: 700;
            color: var(--text-primary);
            margin: 0;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            letter-spacing: 0.025em;
            line-height: 1.2;
        }

        .user-profile-card .profile-role {
            font-size: 0.8rem;
            color: var(--text-secondary);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            font-weight: 500;
            opacity: 0.8;
            line-height: 1.2;
        }

        /* Responsive design pour la section profil */
        @media (max-width: 768px) {
            .user-profile-card {
                padding: 10px;
                gap: 8px;
                min-height: 56px;
            }
            
            .user-profile-card .profile-avatar {
                width: 32px !important;
                height: 32px !important;
                font-size: 1rem !important;
            }
            
            .user-profile-card .profile-name {
                font-size: 0.85rem;
            }
            
            .user-profile-card .profile-role {
                font-size: 0.7rem;
            }
            
            .profile-btn, .logout-btn {
                width: 32px;
                height: 32px;
                min-width: 32px;
                min-height: 32px;
                font-size: 0.9rem;
            }
        }


        .dropdown-menu {
            position: absolute;
            bottom: 100%;
            right: 0;
            background: var(--bg-glass);
            backdrop-filter: var(--backdrop-blur);
            border-radius: 16px;
            box-shadow: var(--shadow-xl);
            border: 1px solid var(--border-primary);
            min-width: 220px;
            z-index: 1000;
            display: none;
            margin-bottom: 12px;
            padding: 8px;
            overflow: hidden;
        }

        .dropdown-menu.show {
            display: block;
        }

        .dropdown-item {
            padding: 12px 16px;
            cursor: pointer;
            transition: all var(--transition-normal);
            border-radius: 10px;
            display: flex;
            align-items: center;
            color: var(--text-primary);
            font-size: 0.9rem;
            font-weight: 500;
            margin: 2px 0;
        }

        .dropdown-item:last-child {
            border-bottom: none;
        }

        .dropdown-item:hover {
            background: var(--bg-tertiary);
            color: var(--primary-color);
            transform: translateX(4px);
        }

        .dropdown-item i {
            margin-right: 12px;
            width: 18px;
            text-align: center;
            font-size: 1rem;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            margin-left: 280px;
            padding: 30px;
            overflow-y: auto;
            background: transparent;
            transition: all var(--transition-slow);
        }

        .dashboard-header {
            margin-bottom: 30px;
        }

        .dashboard-title {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .dashboard-subtitle {
            font-size: 1.1rem;
            color: var(--text-secondary);
        }

        /* Metrics Cards */
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .metric-card {
            background: var(--bg-glass);
            backdrop-filter: var(--backdrop-blur);
            border-radius: 16px;
            padding: 25px;
            box-shadow: var(--shadow-lg);
            border: 1px solid var(--border-primary);
            transition: all var(--transition-normal);
            color: var(--text-primary);
        }

        .metric-card:hover {
            transform: translateY(-5px);
        }

        .metric-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
        }

        .metric-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .metric-icon.blue { background: #DBEAFE; color: #1D4ED8; }
        .metric-icon.green { background: #D1FAE5; color: #059669; }
        .metric-icon.orange { background: #FED7AA; color: #EA580C; }
        .metric-icon.purple { background: #E9D5FF; color: #7C3AED; }

        .metric-trend {
            display: flex;
            align-items: center;
            font-size: 0.8rem;
            color: #059669;
            font-weight: 600;
        }

        .metric-value {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .metric-label {
            color: var(--text-secondary);
            font-size: 0.9rem;
            font-weight: 500;
        }

        /* Quick Actions */
        .quick-actions {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(15px);
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            margin-bottom: 30px;
        }

        .section-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #1F2937;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
        }

        .section-title i {
            margin-right: 10px;
            color: #667eea;
        }

        .actions-list {
            list-style: none;
        }

        .action-item {
            display: flex;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid #E5E7EB;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .action-item:last-child {
            border-bottom: none;
        }

        .action-item:hover {
            background: rgba(102, 126, 234, 0.05);
            border-radius: 8px;
            padding-left: 10px;
        }

        .action-number {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            margin-right: 15px;
        }

        .action-content h4 {
            color: #1F2937;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .action-content p {
            color: #6B7280;
            font-size: 0.9rem;
        }

        /* Charts Section */
        .charts-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .chart-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(15px);
            border-radius: 16px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .chart-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: #1F2937;
            margin-bottom: 20px;
        }

        .chart-placeholder {
            height: 200px;
            background: linear-gradient(135deg, #F3F4F6, #E5E7EB);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #6B7280;
            font-size: 0.9rem;
        }

        .chart-container {
            height: 200px;
            position: relative;
            width: 100%;
        }

        /* Recent Analysis */
        .recent-analysis {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(15px);
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .analysis-table {
            width: 100%;
            border-collapse: collapse;
        }

        .analysis-table th,
        .analysis-table td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #E5E7EB;
        }

        .analysis-table th {
            background: #F9FAFB;
            font-weight: 600;
            color: #374151;
            font-size: 0.9rem;
        }

        .analysis-table td {
            color: #1F2937;
        }

        .status-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .status-excellent {
            background: #D1FAE5;
            color: #059669;
        }

        .status-very-good {
            background: #DBEAFE;
            color: #1D4ED8;
        }

        .status-good {
            background: #FEF3C7;
            color: #D97706;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .sidebar {
                width: 100%;
                position: relative;
                height: auto;
                border-radius: 0;
            }
            
            .main-content {
                margin-left: 0;
                padding: 20px;
            }
            
            .charts-section {
                grid-template-columns: 1fr;
            }
            
            .metrics-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Animations */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .metric-card,
        .quick-actions,
        .chart-card,
        .recent-analysis {
            animation: fadeInUp 0.6s ease-out;
        }

        .metric-card:nth-child(2) { animation-delay: 0.1s; }
        .metric-card:nth-child(3) { animation-delay: 0.2s; }
        .metric-card:nth-child(4) { animation-delay: 0.3s; }

        /* Profile Management Styles */
        .profile-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }

        .profile-card {
            background: var(--bg-glass);
            border: 1px solid var(--border-primary);
            border-radius: 20px;
            padding: 30px;
            box-shadow: var(--shadow-lg);
            backdrop-filter: var(--backdrop-blur);
        }

        .profile-card-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--border-primary);
        }

        .profile-card-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.2rem;
        }

        .profile-card-header h3 {
            font-size: 1.4rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .profile-picture-section {
            text-align: center;
            margin-bottom: 30px;
        }

        .profile-picture {
            position: relative;
            display: inline-block;
            margin-bottom: 15px;
        }

        .profile-avatar-large {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 3rem;
            margin: 0 auto;
            border: 4px solid white;
            box-shadow: var(--shadow-lg);
        }

        .profile-avatar-large img {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            object-fit: cover;
        }

        .upload-btn {
            position: absolute;
            bottom: 5px;
            right: 5px;
            width: 35px;
            height: 35px;
            background: #10B981;
            border: none;
            border-radius: 50%;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
            transition: all 0.3s ease;
        }

        .upload-btn:hover {
            transform: scale(1.1);
        }

        .profile-info {
            text-align: center;
            margin-top: 15px;
        }

        .profile-name {
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 5px;
            text-align: center;
            width: 100%;
        }

        .profile-role {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .info-badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            background: rgba(16, 185, 129, 0.1);
            color: #10B981;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
            margin-top: 10px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: var(--text-primary);
            font-weight: 500;
            font-size: 0.9rem;
        }

        .form-control {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid var(--border-primary);
            border-radius: 10px;
            font-size: 0.95rem;
            transition: all 0.3s ease;
            background: var(--bg-primary);
            color: var(--text-primary);
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .btn-group {
            display: flex;
            gap: 15px;
            margin-top: 25px;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 10px;
            font-size: 0.95rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }

        .btn-secondary {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border: 2px solid var(--border-primary);
        }

        .btn-secondary:hover {
            background: var(--border-primary);
        }

        .btn-outline {
            background: transparent;
            border: 2px solid var(--primary-color);
            color: var(--primary-color);
        }

        .btn-outline:hover {
            background: var(--primary-color);
            color: white;
        }

        .btn-success {
            background: #10B981;
            color: white;
        }

        .btn-success:hover {
            background: #059669;
        }

        .btn-sm {
            padding: 8px 16px;
            font-size: 0.85rem;
        }

        .security-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
        }

        .security-info h4 {
            color: var(--text-primary);
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .security-info p {
            color: var(--text-secondary);
            font-size: 0.85rem;
        }

        .status-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .status-active {
            background: #D1FAE5;
            color: #065F46;
        }

        .status-inactive {
            background: #FEE2E2;
            color: #991B1B;
        }

        .toggle-switch {
            position: relative;
            width: 50px;
            height: 24px;
            background: var(--border-primary);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .toggle-switch.active {
            background: #10B981;
        }

        .toggle-switch::after {
            content: '';
            position: absolute;
            top: 2px;
            left: 2px;
            width: 20px;
            height: 20px;
            background: white;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .toggle-switch.active::after {
            transform: translateX(26px);
        }

        .section-divider {
            height: 1px;
            background: var(--border-primary);
            margin: 20px 0;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        @media (max-width: 768px) {
            .profile-content {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .profile-card {
                padding: 20px;
            }
        }

        /* Modal Styles */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .modal-content {
            background: white;
            border-radius: 15px;
            width: 90%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 25px;
            border-bottom: 1px solid #e5e7eb;
        }

        .modal-header h3 {
            margin: 0;
            color: #374151;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #6b7280;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .modal-close:hover {
            background: #f3f4f6;
            color: #374151;
        }

        .modal-body {
            padding: 25px;
        }

        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 15px;
            padding: 20px 25px;
            border-top: 1px solid #e5e7eb;
        }

        .form-text {
            color: #6b7280;
            font-size: 0.8rem;
            margin-top: 5px;
        }

        /* Session Item Styles */
        .session-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            margin-bottom: 10px;
        }

        .session-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .session-info i {
            font-size: 1.2rem;
            color: #6b7280;
        }

        .session-info strong {
            display: block;
            color: #374151;
            font-size: 0.9rem;
        }

        .session-info small {
            color: #6b7280;
            font-size: 0.8rem;
        }

        /* Alert Styles */
        .alert {
            padding: 12px 16px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .alert-warning {
            background: #fef3cd;
            border: 1px solid #fde68a;
            color: #92400e;
        }

        .alert i {
            font-size: 1.1rem;
        }

        /* Checkbox Styles */
        .form-group label {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
        }

        .form-group input[type="checkbox"] {
            width: auto;
            margin: 0;
        }

        /* Button Danger */
        .btn-danger {
            background: #dc2626;
            color: white;
        }

        .btn-danger:hover {
            background: #b91c1c;
        }

        /* Animations pour les messages temporaires */
        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes slideOut {
            from {
                transform: translateX(0);
                opacity: 1;
            }
            to {
                transform: translateX(100%);
                opacity: 0;
            }
        }

        /* Am√©lioration du bouton d'upload */
        .upload-btn {
            position: absolute;
            bottom: 5px;
            right: 5px;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            background: #10b981;
            color: white;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
            box-shadow: 0 2px 8px rgba(16, 185, 129, 0.3);
            transition: all 0.3s ease;
        }

        .upload-btn:hover {
            background: #059669;
            transform: scale(1.1);
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.4);
        }

        /* Bouton de suppression de photo */
        .remove-photo-btn {
            position: absolute;
            top: 5px;
            right: 5px;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            background: #ef4444;
            color: white;
            border: none;
            cursor: pointer;
            display: none;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            box-shadow: 0 2px 6px rgba(239, 68, 68, 0.3);
            transition: all 0.3s ease;
        }

        .remove-photo-btn:hover {
            background: #dc2626;
            transform: scale(1.1);
        }

        .profile-picture:hover .remove-photo-btn {
            display: flex;
        }

        /* Indicateur de chargement */
        .fa-spinner {
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <!-- Contr√¥les de th√®me et langue - Masqu√©s sur le dashboard -->
    <div class="theme-toggle" id="theme-toggle" title="Basculer le th√®me" style="display: none;">
        üåô
    </div>
    
    <div class="language-selector" style="display: none;">
        <select id="language-select" onchange="handleLanguageChange(this)">
            <option value="fr">üá´üá∑ FR</option>
            <option value="en">üá∫üá∏ EN</option>
        </select>
    </div>
    <!-- Sidebar -->
    <div class="sidebar">
        <div class="logo">
            <div class="logo-icon" style="display: flex; align-items: center; justify-content: center; gap: 20px; width: 100%; margin-bottom: 10px;">
                <img src="Logos/TalentScope.png" alt="TalentScope Logo" style="width: 60px; height: 60px; object-fit: contain;">
                <img src="Logos/MEF2.png" alt="Minist√®re Logo" style="width: 60px; height: 60px; object-fit: contain;">
            </div>
            <h1>TalentScope</h1>
            <p>Minist√®re de l'√âconomie et des Finances</p>
        </div>

        <div class="nav-section">
            <div class="nav-title">Navigation</div>
            <a href="#" class="nav-item" onclick="showSection('home')">
                <i class="fas fa-home fa-fw"></i>
                <div>
                    <div data-translate="nav.home">Accueil</div>
                    <div class="subtitle" data-translate="nav.home_subtitle">Page principale</div>
                </div>
            </a>
            <a href="#" class="nav-item active" onclick="showSection('dashboard')">
                <i class="fas fa-chart-bar fa-fw"></i>
                <div>
                    <div data-translate="nav.dashboard">Tableau de Bord</div>
                    <div class="subtitle" data-translate="nav.dashboard_subtitle">Vue d'ensemble</div>
                </div>
            </a>
            <a href="#" class="nav-item" onclick="showSection('analysis')">
                <i class="fas fa-rocket fa-fw"></i>
                <div>
                    <div data-translate="nav.analysis">Nouvelle Analyse</div>
                    <div class="subtitle" data-translate="nav.analysis_subtitle">Analyser des CVs</div>
                </div>
            </a>
            <a href="#" class="nav-item" onclick="showSection('processed')">
                <i class="fas fa-folder fa-fw"></i>
                <div>
                    <div data-translate="nav.history">CVs Trait√©s</div>
                    <div class="subtitle" data-translate="nav.history_subtitle">Historique des analyses</div>
                </div>
            </a>
            <a href="#" class="nav-item" onclick="showSection('config')">
                <i class="fas fa-cog fa-fw"></i>
                <div>
                    <div data-translate="nav.config">Configuration</div>
                    <div class="subtitle" data-translate="nav.config_subtitle">Param√®tres syst√®me</div>
                </div>
            </a>
        </div>


        <!-- User Profile Section -->
        <div class="user-info">
            <div class="user-profile-card">
                <div class="profile-photo">
                    <div class="profile-avatar" id="sidebar-profile-avatar">
                        <i class="fas fa-user"></i>
                        <div class="status-indicator"></div>
                    </div>
                </div>
                <div class="profile-info">
                    <div class="profile-name" id="user-fullname">Utilisateur</div>
                    <div class="profile-role">Minist√®re des Finances</div>
                    <div class="profile-status">
                        <span class="status-dot"></span>
                        <span class="status-text">En ligne</span>
                    </div>
                </div>
                <div class="profile-actions">
                    <button class="profile-btn" onclick="showSection('profile')" title="Gestion du profil">
                        <i class="fas fa-cog"></i>
                    </button>
                    <button class="logout-btn" onclick="logout()" title="Se d√©connecter">
                        <i class="fas fa-sign-out-alt"></i>
                    </button>
                    <div class="dropdown-menu" id="profileDropdown">
                        <div class="dropdown-item" onclick="editProfile()">
                            <i class="fas fa-edit"></i>
                            Modifier le profil
                        </div>
                        <div class="dropdown-item" onclick="changePassword()">
                            <i class="fas fa-lock"></i>
                            Changer le mot de passe
                        </div>
                        <div class="dropdown-item" onclick="viewSettings()">
                            <i class="fas fa-cog"></i>
                            Param√®tres
                        </div>
                        <div class="dropdown-item" onclick="logout()" style="color: #dc2626;">
                            <i class="fas fa-sign-out-alt"></i>
                            D√©connexion
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <!-- Dashboard Section -->
        <div id="dashboard-section" class="content-section">
            <div class="dashboard-header">
                <h1 class="dashboard-title" data-translate="dashboard.title">Tableau de Bord</h1>
                <p class="dashboard-subtitle" data-translate="dashboard.subtitle">Vue d'ensemble de vos analyses et statistiques</p>
            </div>

            <!-- Metrics Cards -->
            <div class="metrics-grid">
                <div class="metric-card">
                    <div class="metric-header">
                        <div class="metric-icon blue"><i class="fas fa-chart-line"></i></div>
                        <div class="metric-trend" id="analyses-trend">‚Üó +2 cette semaine</div>
                    </div>
                    <div class="metric-value" id="analyses-count">3</div>
                    <div class="metric-label" data-translate="dashboard.total_cvs">Analyses Effectu√©es</div>
                </div>

                <div class="metric-card">
                    <div class="metric-header">
                        <div class="metric-icon green"><i class="fas fa-file-alt"></i></div>
                        <div class="metric-trend" id="cvs-trend">‚Üó +5 cette semaine</div>
                    </div>
                    <div class="metric-value" id="cvs-count">7</div>
                    <div class="metric-label" data-translate="dashboard.total_cvs">CVs Trait√©s</div>
                </div>

                <div class="metric-card">
                    <div class="metric-header">
                        <div class="metric-icon orange"><i class="fas fa-chart-bar"></i></div>
                        <div class="metric-trend" id="score-trend">‚Üó +3.2% cette semaine</div>
                    </div>
                    <div class="metric-value" id="average-score">82.3%</div>
                    <div class="metric-label" data-translate="dashboard.avg_score">Score Moyen</div>
                </div>

                <div class="metric-card">
                    <div class="metric-header">
                        <div class="metric-icon purple"><i class="fas fa-check-circle"></i></div>
                        <div class="metric-trend" id="success-trend">‚Üó +2.1% cette semaine</div>
                    </div>
                    <div class="metric-value" id="success-rate">87.5%</div>
                    <div class="metric-label" data-translate="dashboard.success_rate">Taux de R√©ussite</div>
                </div>
            </div>

            <!-- Charts Section -->
            <div class="charts-section">
                <div class="chart-card">
                    <h3 class="chart-title"><i class="fas fa-chart-line"></i> Tendance des Analyses</h3>
                    <div class="chart-container">
                        <div id="analysisTrendChart" style="width: 100%; height: 250px; background: linear-gradient(135deg, rgba(102, 126, 234, 0.05), rgba(118, 75, 162, 0.05)); border-radius: 12px; padding: 20px;">
                            <div style="height: 200px; display: flex; align-items: end; justify-content: space-around; padding: 20px;">
                                <div style="display: flex; flex-direction: column; align-items: center; animation: slideInUp 0.6s ease 0s both;">
                                    <div style="width: 35px; height: 60px; background: linear-gradient(135deg, #667eea, #764ba2); border-radius: 6px; margin-bottom: 10px; box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3); transition: all 0.3s ease; position: relative;">
                                        <div style="position: absolute; top: -25px; left: 50%; transform: translateX(-50%); background: #667eea; color: white; padding: 2px 6px; border-radius: 4px; font-size: 10px; font-weight: bold;">2</div>
                                    </div>
                                    <span style="font-size: 11px; color: #666; font-weight: 500;">Sem 1</span>
                                </div>
                                <div style="display: flex; flex-direction: column; align-items: center; animation: slideInUp 0.6s ease 0.1s both;">
                                    <div style="width: 35px; height: 100px; background: linear-gradient(135deg, #667eea, #764ba2); border-radius: 6px; margin-bottom: 10px; box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3); transition: all 0.3s ease; position: relative;">
                                        <div style="position: absolute; top: -25px; left: 50%; transform: translateX(-50%); background: #667eea; color: white; padding: 2px 6px; border-radius: 4px; font-size: 10px; font-weight: bold;">4</div>
                                    </div>
                                    <span style="font-size: 11px; color: #666; font-weight: 500;">Sem 2</span>
                                </div>
                                <div style="display: flex; flex-direction: column; align-items: center; animation: slideInUp 0.6s ease 0.2s both;">
                                    <div style="width: 35px; height: 80px; background: linear-gradient(135deg, #667eea, #764ba2); border-radius: 6px; margin-bottom: 10px; box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3); transition: all 0.3s ease; position: relative;">
                                        <div style="position: absolute; top: -25px; left: 50%; transform: translateX(-50%); background: #667eea; color: white; padding: 2px 6px; border-radius: 4px; font-size: 10px; font-weight: bold;">3</div>
                                    </div>
                                    <span style="font-size: 11px; color: #666; font-weight: 500;">Sem 3</span>
                                </div>
                                <div style="display: flex; flex-direction: column; align-items: center; animation: slideInUp 0.6s ease 0.3s both;">
                                    <div style="width: 35px; height: 120px; background: linear-gradient(135deg, #667eea, #764ba2); border-radius: 6px; margin-bottom: 10px; box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3); transition: all 0.3s ease; position: relative;">
                                        <div style="position: absolute; top: -25px; left: 50%; transform: translateX(-50%); background: #667eea; color: white; padding: 2px 6px; border-radius: 4px; font-size: 10px; font-weight: bold;">5</div>
                                    </div>
                                    <span style="font-size: 11px; color: #666; font-weight: 500;">Sem 4</span>
                                </div>
                                <div style="display: flex; flex-direction: column; align-items: center; animation: slideInUp 0.6s ease 0.4s both;">
                                    <div style="width: 35px; height: 160px; background: linear-gradient(135deg, #667eea, #764ba2); border-radius: 6px; margin-bottom: 10px; box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3); transition: all 0.3s ease; position: relative;">
                                        <div style="position: absolute; top: -25px; left: 50%; transform: translateX(-50%); background: #667eea; color: white; padding: 2px 6px; border-radius: 4px; font-size: 10px; font-weight: bold;">7</div>
                                    </div>
                                    <span style="font-size: 11px; color: #666; font-weight: 500;">Sem 5</span>
                                </div>
                                <div style="display: flex; flex-direction: column; align-items: center; animation: slideInUp 0.6s ease 0.5s both;">
                                    <div style="width: 35px; height: 140px; background: linear-gradient(135deg, #667eea, #764ba2); border-radius: 6px; margin-bottom: 10px; box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3); transition: all 0.3s ease; position: relative;">
                                        <div style="position: absolute; top: -25px; left: 50%; transform: translateX(-50%); background: #667eea; color: white; padding: 2px 6px; border-radius: 4px; font-size: 10px; font-weight: bold;">6</div>
                                    </div>
                                    <span style="font-size: 11px; color: #666; font-weight: 500;">Sem 6</span>
                                </div>
                                <div style="display: flex; flex-direction: column; align-items: center; animation: slideInUp 0.6s ease 0.6s both;">
                                    <div style="width: 35px; height: 100px; background: linear-gradient(135deg, #667eea, #764ba2); border-radius: 6px; margin-bottom: 10px; box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3); transition: all 0.3s ease; position: relative;">
                                        <div style="position: absolute; top: -25px; left: 50%; transform: translateX(-50%); background: #667eea; color: white; padding: 2px 6px; border-radius: 4px; font-size: 10px; font-weight: bold;">4</div>
                                    </div>
                                    <span style="font-size: 11px; color: #666; font-weight: 500;">Sem 7</span>
                                </div>
                                <div style="display: flex; flex-direction: column; align-items: center; animation: slideInUp 0.6s ease 0.7s both;">
                                    <div style="width: 35px; height: 80px; background: linear-gradient(135deg, #667eea, #764ba2); border-radius: 6px; margin-bottom: 10px; box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3); transition: all 0.3s ease; position: relative;">
                                        <div style="position: absolute; top: -25px; left: 50%; transform: translateX(-50%); background: #667eea; color: white; padding: 2px 6px; border-radius: 4px; font-size: 10px; font-weight: bold;">3</div>
                                    </div>
                                    <span style="font-size: 11px; color: #666; font-weight: 500;">Sem 8</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="chart-card">
                    <h3 class="chart-title"><i class="fas fa-chart-bar"></i> Distribution des Scores</h3>
                    <div class="chart-container">
                        <div id="scoreDistributionChart" style="width: 100%; height: 250px; background: linear-gradient(135deg, rgba(16, 185, 129, 0.05), rgba(5, 150, 105, 0.05)); border-radius: 12px; padding: 20px;">
                            <div style="height: 200px; display: flex; align-items: end; justify-content: space-around; padding: 20px;">
                                <div style="display: flex; flex-direction: column; align-items: center; animation: slideInUp 0.6s ease 0s both;">
                                    <div style="width: 45px; height: 40px; background: linear-gradient(135deg, #10b981, #059669); border-radius: 6px; margin-bottom: 10px; box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3); transition: all 0.3s ease; position: relative;">
                                        <div style="position: absolute; top: -25px; left: 50%; transform: translateX(-50%); background: #10b981; color: white; padding: 2px 6px; border-radius: 4px; font-size: 10px; font-weight: bold;">1</div>
                    </div>
                                    <span style="font-size: 10px; color: #666; font-weight: 500; text-align: center;">0-20%</span>
                </div>
                                <div style="display: flex; flex-direction: column; align-items: center; animation: slideInUp 0.6s ease 0.1s both;">
                                    <div style="width: 45px; height: 60px; background: linear-gradient(135deg, #10b981, #059669); border-radius: 6px; margin-bottom: 10px; box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3); transition: all 0.3s ease; position: relative;">
                                        <div style="position: absolute; top: -25px; left: 50%; transform: translateX(-50%); background: #10b981; color: white; padding: 2px 6px; border-radius: 4px; font-size: 10px; font-weight: bold;">2</div>
            </div>
                                    <span style="font-size: 10px; color: #666; font-weight: 500; text-align: center;">21-40%</span>
                        </div>
                                <div style="display: flex; flex-direction: column; align-items: center; animation: slideInUp 0.6s ease 0.2s both;">
                                    <div style="width: 45px; height: 80px; background: linear-gradient(135deg, #10b981, #059669); border-radius: 6px; margin-bottom: 10px; box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3); transition: all 0.3s ease; position: relative;">
                                        <div style="position: absolute; top: -25px; left: 50%; transform: translateX(-50%); background: #10b981; color: white; padding: 2px 6px; border-radius: 4px; font-size: 10px; font-weight: bold;">4</div>
                        </div>
                                    <span style="font-size: 10px; color: #666; font-weight: 500; text-align: center;">41-60%</span>
                                </div>
                                <div style="display: flex; flex-direction: column; align-items: center; animation: slideInUp 0.6s ease 0.3s both;">
                                    <div style="width: 45px; height: 120px; background: linear-gradient(135deg, #10b981, #059669); border-radius: 6px; margin-bottom: 10px; box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3); transition: all 0.3s ease; position: relative;">
                                        <div style="position: absolute; top: -25px; left: 50%; transform: translateX(-50%); background: #10b981; color: white; padding: 2px 6px; border-radius: 4px; font-size: 10px; font-weight: bold;">8</div>
                                    </div>
                                    <span style="font-size: 10px; color: #666; font-weight: 500; text-align: center;">61-80%</span>
                                </div>
                                <div style="display: flex; flex-direction: column; align-items: center; animation: slideInUp 0.6s ease 0.4s both;">
                                    <div style="width: 45px; height: 160px; background: linear-gradient(135deg, #10b981, #059669); border-radius: 6px; margin-bottom: 10px; box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3); transition: all 0.3s ease; position: relative;">
                                        <div style="position: absolute; top: -25px; left: 50%; transform: translateX(-50%); background: #10b981; color: white; padding: 2px 6px; border-radius: 4px; font-size: 10px; font-weight: bold;">12</div>
                                    </div>
                                    <span style="font-size: 10px; color: #666; font-weight: 500; text-align: center;">81-100%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>


            <!-- Recent Analysis -->
            <div class="recent-analysis">
                <h2 class="section-title">
                    <i><i class="fas fa-clipboard"></i></i>
                    Derni√®res Analyses
                </h2>
                <table class="analysis-table">
                    <thead>
                        <tr>
                            <th>Nom du CV</th>
                            <th>Score</th>
                            <th>Statut</th>
                            <th>Poste</th>
                            <th>Date</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>cv_Hamza.pdf</td>
                            <td>91.3%</td>
                            <td><span class="status-badge status-excellent">Excellent</span></td>
                            <td>Data Scientist</td>
                            <td>18/09/2024</td>
                        </tr>
                        <tr>
                            <td>cv_Sophia.pdf</td>
                            <td>76.1%</td>
                            <td><span class="status-badge status-very-good">Tr√®s bon</span></td>
                            <td>D√©veloppeur Python</td>
                            <td>17/09/2024</td>
                        </tr>
                        <tr>
                            <td>cv_Adam.pdf</td>
                            <td>85.2%</td>
                            <td><span class="status-badge status-excellent">Excellent</span></td>
                            <td>Analyste Data</td>
                            <td>16/09/2024</td>
                        </tr>
                        <tr>
                            <td>cv_Ali.pdf</td>
                            <td>72.8%</td>
                            <td><span class="status-badge status-good">Bon</span></td>
                            <td>Ing√©nieur ML</td>
                            <td>15/09/2024</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Other Sections (Hidden by default) -->
        <div id="home-section" class="content-section" style="display: none;">
            <div class="dashboard-header">
                <h1 class="dashboard-title">Accueil</h1>
                <p class="dashboard-subtitle">Guide d'utilisation de TalentScope</p>
            </div>

            <!-- Section Minist√®re -->
            <div class="quick-actions" style="margin-bottom: 30px;">
                <h2 class="section-title">
                    <i><i class="fas fa-landmark"></i></i>
                    Minist√®re de l'√âconomie et des Finances
                </h2>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                    <div style="background: linear-gradient(135deg, #f0f9ff, #e0f2fe); padding: 20px; border-radius: 12px; border-left: 4px solid #0ea5e9;">
                        <h3 style="color: #0c4a6e; margin-bottom: 10px;"><i class="fas fa-bullseye"></i> Mission</h3>
                        <p style="color: #0c4a6e; margin: 0; line-height: 1.6;">
                            Le Minist√®re de l'√âconomie et des Finances du Maroc ≈ìuvre pour le d√©veloppement √©conomique durable, 
                            la gestion des finances publiques et l'am√©lioration du climat des affaires.
                        </p>
                    </div>
                    <div style="background: linear-gradient(135deg, #f0fdf4, #dcfce7); padding: 20px; border-radius: 12px; border-left: 4px solid #22c55e;">
                        <h3 style="color: #14532d; margin-bottom: 10px;"><i class="fas fa-chart-bar"></i> Objectifs</h3>
                        <p style="color: #14532d; margin: 0; line-height: 1.6;">
                            Moderniser l'administration publique, optimiser les processus de recrutement et 
                            garantir l'excellence dans la gestion des talents au service de l'√âtat.
                        </p>
                    </div>
                </div>
            </div>

            <!-- Guide d'utilisation -->
            <div class="quick-actions" style="margin-bottom: 30px;">
                <h2 class="section-title">
                    <i><i class="fas fa-book"></i></i>
                    Guide d'utilisation de TalentScope
                </h2>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 20px;">
                    <!-- √âtape 1 -->
                    <div style="background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1); border-left: 4px solid #667eea;">
                        <div style="display: flex; align-items: center; margin-bottom: 15px;">
                            <div style="background: #667eea; color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; margin-right: 10px;">1</div>
                            <h3 style="margin: 0; color: #374151;">Pr√©paration de l'offre</h3>
                        </div>
                        <p style="color: #6B7280; margin: 0; line-height: 1.6;">
                            R√©digez une description d√©taill√©e du poste, listez les comp√©tences requises et sp√©cifiez le niveau d'exp√©rience souhait√©.
                        </p>
                    </div>

                    <!-- √âtape 2 -->
                    <div style="background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1); border-left: 4px solid #10b981;">
                        <div style="display: flex; align-items: center; margin-bottom: 15px;">
                            <div style="background: #10b981; color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; margin-right: 10px;">2</div>
                            <h3 style="margin: 0; color: #374151;">Importation des CVs</h3>
                        </div>
                        <p style="color: #6B7280; margin: 0; line-height: 1.6;">
                            Importez les CVs des candidats en format PDF ou Word. Le syst√®me supporte l'analyse de plusieurs fichiers simultan√©ment.
                        </p>
                    </div>

                    <!-- √âtape 3 -->
                    <div style="background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1); border-left: 4px solid #f59e0b;">
                        <div style="display: flex; align-items: center; margin-bottom: 15px;">
                            <div style="background: #f59e0b; color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; margin-right: 10px;">3</div>
                            <h3 style="margin: 0; color: #374151;">Analyse intelligente</h3>
                        </div>
                        <p style="color: #6B7280; margin: 0; line-height: 1.6;">
                            Notre algorithme de Machine Learning analyse chaque CV et calcule un score de compatibilit√© bas√© sur plusieurs crit√®res.
                        </p>
                    </div>

                    <!-- √âtape 4 -->
                    <div style="background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1); border-left: 4px solid #8b5cf6;">
                        <div style="display: flex; align-items: center; margin-bottom: 15px;">
                            <div style="background: #8b5cf6; color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; margin-right: 10px;">4</div>
                            <h3 style="margin: 0; color: #374151;">R√©sultats et classement</h3>
                        </div>
                        <p style="color: #6B7280; margin: 0; line-height: 1.6;">
                            Consultez le classement des candidats, visualisez les CVs et acc√©dez √† l'analyse d√©taill√©e pour chaque profil.
                        </p>
                    </div>
                </div>
            </div>

            <!-- Fonctionnalit√©s principales -->
            <div class="quick-actions" style="margin-bottom: 30px;">
                <h2 class="section-title">
                    <i><i class="fas fa-bolt"></i></i>
                    Fonctionnalit√©s principales
                </h2>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
                    <div style="background: #f8fafc; padding: 15px; border-radius: 10px; border: 1px solid #e2e8f0;">
                        <div style="display: flex; align-items: center; margin-bottom: 10px;">
                            <span style="font-size: 1.5rem; margin-right: 10px;"><i class="fas fa-robot"></i></span>
                            <h4 style="margin: 0; color: #374151;">IA Avanc√©e</h4>
                        </div>
                        <p style="color: #6B7280; margin: 0; font-size: 0.9rem;">Algorithmes de Machine Learning pour une analyse pr√©cise</p>
                    </div>

                    <div style="background: #f8fafc; padding: 15px; border-radius: 10px; border: 1px solid #e2e8f0;">
                        <div style="display: flex; align-items: center; margin-bottom: 10px;">
                            <span style="font-size: 1.5rem; margin-right: 10px;"><i class="fas fa-chart-bar"></i></span>
                            <h4 style="margin: 0; color: #374151;">Classement intelligent</h4>
                        </div>
                        <p style="color: #6B7280; margin: 0; font-size: 0.9rem;">Tri automatique des candidats par pertinence</p>
                    </div>

                    <div style="background: #f8fafc; padding: 15px; border-radius: 10px; border: 1px solid #e2e8f0;">
                        <div style="display: flex; align-items: center; margin-bottom: 10px;">
                            <span style="font-size: 1.5rem; margin-right: 10px;"><i class="fas fa-search"></i></span>
                            <h4 style="margin: 0; color: #374151;">Analyse d√©taill√©e</h4>
                        </div>
                        <p style="color: #6B7280; margin: 0; font-size: 0.9rem;">Breakdown complet des scores et recommandations</p>
                    </div>

                    <div style="background: #f8fafc; padding: 15px; border-radius: 10px; border: 1px solid #e2e8f0;">
                        <div style="display: flex; align-items: center; margin-bottom: 10px;">
                            <span style="font-size: 1.5rem; margin-right: 10px;"><i class="fas fa-chart-line"></i></span>
                            <h4 style="margin: 0; color: #374151;">Statistiques</h4>
                        </div>
                        <p style="color: #6B7280; margin: 0; font-size: 0.9rem;">M√©triques et tendances des analyses</p>
                    </div>
                </div>
            </div>

        </div>

        <div id="analysis-section" class="content-section" style="display: none;">
            <div class="dashboard-header">
                <h1 class="dashboard-title">Nouvelle Analyse</h1>
                <p class="dashboard-subtitle">Analyser des CVs avec l'IA</p>
            </div>
            <div class="quick-actions">
                <h2 class="section-title">
                    <i class="fas fa-rocket fa-fw"></i>
                    Interface d'Analyse Moderne
                </h2>
                <p style="color: #6B7280; margin-bottom: 20px;">
                    Lancez une analyse compl√®te de CVs en 5 √©tapes simples avec notre interface moderne.
                </p>
                <div style="text-align: center; padding: 40px; background: linear-gradient(135deg, #F3F4F6, #E5E7EB); border-radius: 12px;">
                    <h3 style="color: #1F2937; margin-bottom: 20px;"><i class="fas fa-bullseye"></i> Pr√™t √† analyser des CVs ?</h3>
                    <p style="color: #6B7280; margin-bottom: 30px;">Notre interface moderne vous guide √† travers 5 √©tapes simples</p>
                    <button onclick="window.location.href='/analysis'" 
                            style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; border: none; padding: 15px 30px; border-radius: 12px; font-size: 1.1rem; font-weight: 600; cursor: pointer; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3); transition: all 0.3s ease;"
                            onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(102, 126, 234, 0.4)'"
                            onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(102, 126, 234, 0.3)'">
                        <i class="fas fa-rocket"></i> Commencer l'analyse
                    </button>
                </div>
            </div>
        </div>

        <div id="processed-section" class="content-section" style="display: none;">
            <div class="dashboard-header">
                <h1 class="dashboard-title">CVs Trait√©s</h1>
                <p class="dashboard-subtitle">Historique des analyses</p>
            </div>
            <div class="recent-analysis">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h2 class="section-title" style="margin: 0;">
                        <i class="fas fa-folder fa-fw"></i>
                        Historique Complet
                    </h2>
                    <div style="display: flex; gap: 10px;">
                        <button onclick="createTestAnalysis()" 
                                style="background: #10B981; color: white; border: none; padding: 8px 16px; border-radius: 8px; cursor: pointer; font-weight: 600; display: flex; align-items: center; gap: 6px; font-size: 0.9rem; transition: all 0.3s ease;"
                                onmouseover="this.style.background='#059669'; this.style.transform='translateY(-2px)'"
                                onmouseout="this.style.background='#10B981'; this.style.transform='translateY(0)'"
                                title="Simuler une nouvelle analyse pour tester l'historique">
                            <i class="fas fa-plus"></i> Test Analyse
                        </button>
                        <button onclick="resetDashboardData()" 
                                style="background: #3B82F6; color: white; border: none; padding: 8px 16px; border-radius: 8px; cursor: pointer; font-weight: 600; display: flex; align-items: center; gap: 6px; font-size: 0.9rem; transition: all 0.3s ease;"
                                onmouseover="this.style.background='#2563EB'; this.style.transform='translateY(-2px)'"
                                onmouseout="this.style.background='#3B82F6'; this.style.transform='translateY(0)'"
                                title="R√©initialiser les donn√©es du dashboard">
                            <i class="fas fa-sync-alt"></i> Reset Dashboard
                        </button>
                        <button onclick="forceDashboardUpdate()" 
                                style="background: #F59E0B; color: white; border: none; padding: 8px 16px; border-radius: 8px; cursor: pointer; font-weight: 600; display: flex; align-items: center; gap: 6px; font-size: 0.9rem; transition: all 0.3s ease;"
                                onmouseover="this.style.background='#D97706'; this.style.transform='translateY(-2px)'"
                                onmouseout="this.style.background='#F59E0B'; this.style.transform='translateY(0)'"
                                title="Forcer la mise √† jour du dashboard">
                            <i class="fas fa-refresh"></i> Force Update
                        </button>
                        <button onclick="showChartsInstantly()" 
                                style="background: #8B5CF6; color: white; border: none; padding: 8px 16px; border-radius: 8px; cursor: pointer; font-weight: 600; display: flex; align-items: center; gap: 6px; font-size: 0.9rem; transition: all 0.3s ease;"
                                onmouseover="this.style.background='#7C3AED'; this.style.transform='translateY(-2px)'"
                                onmouseout="this.style.background='#8B5CF6'; this.style.transform='translateY(0)'"
                                title="Afficher les graphiques instantan√©ment">
                            <i class="fas fa-chart-bar"></i> Show Charts
                        </button>
                    <button onclick="clearHistory()" 
                            style="background: #F59E0B; color: white; border: none; padding: 8px 16px; border-radius: 8px; cursor: pointer; font-weight: 600; display: flex; align-items: center; gap: 6px; font-size: 0.9rem; transition: all 0.3s ease;"
                            onmouseover="this.style.background='#D97706'; this.style.transform='translateY(-2px)'"
                            onmouseout="this.style.background='#F59E0B'; this.style.transform='translateY(0)'">
                        <i class="fas fa-trash-alt"></i> Supprimer l'historique
                    </button>
                    </div>
                </div>
                <table class="analysis-table">
                    <thead>
                        <tr>
                            <th>Nom du CV</th>
                            <th>Score</th>
                            <th>Statut</th>
                            <th>Poste</th>
                            <th>Date</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Le contenu sera g√©n√©r√© dynamiquement par JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>

        <div id="config-section" class="content-section" style="display: none;">
            <div class="dashboard-header">
                <h1 class="dashboard-title" data-translate="config.title">Configuration</h1>
                <p class="dashboard-subtitle" data-translate="config.subtitle">Param√®tres de l'application</p>
            </div>
            <div class="quick-actions">
                <h2 class="section-title">
                    <i class="fas fa-cog fa-fw"></i>
                    <span data-translate="config.title">Param√®tres</span>
                </h2>
                <div style="display: grid; gap: 20px;">
                    <div class="config-card">
                        <div class="config-header">
                            <i class="fas fa-palette"></i>
                            <h4 data-translate="config.theme">Th√®me</h4>
                        </div>
                        <p class="config-description" data-translate="config.theme_description">Choisissez le th√®me de l'interface</p>
                        <div class="theme-selector">
                            <button class="theme-option active" data-theme="light" onclick="setTheme('light')">
                                <i class="fas fa-sun"></i>
                                <span>Clair</span>
                            </button>
                            <button class="theme-option" data-theme="dark" onclick="setTheme('dark')">
                                <i class="fas fa-moon"></i>
                                <span>Sombre</span>
                            </button>
                        </div>
                    </div>
                    <div style="background: #F9FAFB; padding: 20px; border-radius: 12px;">
                        <h4 style="color: #1F2937; margin-bottom: 10px;" data-translate="config.language">Langue</h4>
                        <p style="color: #6B7280; margin-bottom: 15px;" data-translate="config.language_description">S√©lectionnez la langue de l'interface</p>
                        <select id="config-language-select" style="width: 100%; padding: 10px; border: 1px solid #D1D5DB; border-radius: 8px;" onchange="handleLanguageChange(this)">
                            <option value="fr" data-translate="lang.fr">Fran√ßais</option>
                            <option value="en" data-translate="lang.en">English</option>
                        </select>
                    </div>
                    <div style="background: #F9FAFB; padding: 20px; border-radius: 12px;">
                        <h4 style="color: #1F2937; margin-bottom: 10px;" data-translate="config.notifications">Notifications</h4>
                        <p style="color: #6B7280; margin-bottom: 15px;" data-translate="config.notifications_description">Configurez vos pr√©f√©rences de notification</p>
                        <label style="display: flex; align-items: center; margin-bottom: 10px;">
                            <input type="checkbox" checked style="margin-right: 10px;">
                            <span data-translate="config.email_notifications">Notifications par email</span>
                        </label>
                        <label style="display: flex; align-items: center;">
                            <input type="checkbox" checked style="margin-right: 10px;">
                            <span data-translate="config.push_notifications">Notifications push</span>
                        </label>
                    </div>
                    
                    <div style="background: #FEF2F2; padding: 20px; border-radius: 12px; border-left: 4px solid #EF4444;">
                        <h4 style="color: #DC2626; margin-bottom: 10px;"><i class="fas fa-exclamation-triangle"></i> <span data-translate="config.danger_zone">Zone de danger</span></h4>
                        <p style="color: #7F1D1D; margin-bottom: 15px;" data-translate="config.danger_description">Actions irr√©versibles - Proc√©dez avec prudence</p>
                        
                        <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                            <button onclick="clearHistory()" 
                                    style="background: #F59E0B; color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-weight: 600; display: flex; align-items: center; gap: 8px; transition: all 0.3s ease;"
                                    onmouseover="this.style.background='#D97706'; this.style.transform='translateY(-2px)'"
                                    onmouseout="this.style.background='#F59E0B'; this.style.transform='translateY(0)'">
                                <i class="fas fa-trash-alt"></i> Supprimer l'historique
                            </button>
                            
                            <button onclick="resetApplication()" 
                                    style="background: #DC2626; color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-weight: 600; display: flex; align-items: center; gap: 8px; transition: all 0.3s ease;"
                                    onmouseover="this.style.background='#B91C1C'; this.style.transform='translateY(-2px)'"
                                    onmouseout="this.style.background='#DC2626'; this.style.transform='translateY(0)'">
                                <i class="fas fa-sync"></i> <span data-translate="config.reset_site">R√©initialiser le site</span>
                            </button>
                        </div>
                        
                        <div style="margin-top: 15px; padding: 10px; background: #FEE2E2; border-radius: 6px; border: 1px solid #FECACA;">
                            <p style="margin: 0; font-size: 0.9rem; color: #991B1B;">
                                <strong>Attention:</strong> Ces actions supprimeront d√©finitivement toutes les donn√©es d'analyse et l'historique. 
                                Cette action ne peut pas √™tre annul√©e.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Profile Management Section -->
        <div id="profile-section" class="content-section" style="display: none;">
            <div class="dashboard-header">
                <h1 class="dashboard-title">Gestion du Profil</h1>
                <p class="dashboard-subtitle">G√©rez vos informations personnelles et param√®tres de s√©curit√©</p>
            </div>
            
            <div class="profile-content">
                <!-- Informations Personnelles -->
                <div class="profile-card">
                    <div class="profile-card-header">
                        <div class="profile-card-icon">
                            <i class="fas fa-user"></i>
                        </div>
                        <h3>Informations Personnelles</h3>
                    </div>
                    
                    <div class="profile-picture-section">
                        <div class="profile-picture">
                            <div class="profile-avatar-large" id="profile-avatar-large">
                                <i class="fas fa-user"></i>
                            </div>
                            <button class="upload-btn" onclick="uploadProfilePicture()" title="Changer la photo de profil">
                                <i class="fas fa-camera"></i>
                            </button>
                            <button class="remove-photo-btn" onclick="removeProfilePicture()" title="Supprimer la photo de profil">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        <div class="profile-info">
                            <div class="profile-name" id="profile-name">Akjouj Hamza</div>
                            <div class="profile-role" id="profile-role">D√©veloppeur Senior</div>
                            <div class="info-badge">
                                <i class="fas fa-shield-alt"></i>
                                Compte v√©rifi√©
                            </div>
                        </div>
                    </div>

                    <form id="profile-form">
                        <div class="form-group">
                            <label for="full-name">Nom complet</label>
                            <input type="text" id="full-name" class="form-control" value="Akjouj Hamza" required>
                        </div>

                        <div class="form-group">
                            <label for="email">Adresse e-mail professionnelle</label>
                            <input type="email" id="email" class="form-control" value="akjouj17@gmail.com" required>
                        </div>

                        <div class="form-group">
                            <label for="department">D√©partement</label>
                            <select id="department" class="form-control" required>
                                <option value="development">D√©veloppement</option>
                                <option value="finance">Finance</option>
                                <option value="hr">Ressources Humaines</option>
                                <option value="marketing">Marketing</option>
                                <option value="operations">Op√©rations</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="position">Poste</label>
                            <input type="text" id="position" class="form-control" value="D√©veloppeur Senior" required>
                        </div>

                        <div class="form-group">
                            <label for="phone">T√©l√©phone professionnel</label>
                            <input type="tel" id="phone" class="form-control" value="+212 6 12 34 56 78">
                        </div>

                        <div class="btn-group">
                            <button type="button" class="btn btn-secondary" onclick="resetProfileForm()">
                                <i class="fas fa-undo"></i> Annuler
                            </button>
                            <button type="button" class="btn btn-primary" id="save-profile-btn">
                                <i class="fas fa-save"></i> Enregistrer
                            </button>
                        </div>
                    </form>
                </div>

                <!-- S√©curit√© -->
                <div class="profile-card">
                    <div class="profile-card-header">
                        <div class="profile-card-icon">
                            <i class="fas fa-shield-alt"></i>
                        </div>
                        <h3>S√©curit√© du Compte</h3>
                    </div>

                    <div class="security-item">
                        <div class="security-info">
                            <h4>Mot de passe</h4>
                            <p id="password-last-modified">Derni√®re modification il y a 30 jours</p>
                        </div>
                        <div class="security-status">
                            <span class="status-badge status-active">S√©curis√©</span>
                            <button class="btn btn-outline btn-sm" onclick="openPasswordModal()">
                                <i class="fas fa-key"></i> Modifier
                            </button>
                        </div>
                    </div>

                    <div class="section-divider"></div>

                    <div class="security-item">
                        <div class="security-info">
                            <h4>Authentification √† deux facteurs</h4>
                            <p>Ajoutez une couche de s√©curit√© suppl√©mentaire</p>
                        </div>
                        <div class="security-status">
                            <span class="status-badge status-inactive">Non activ√©</span>
                            <button class="btn btn-success btn-sm" onclick="open2FAModal()">
                                <i class="fas fa-mobile-alt"></i> Activer
                            </button>
                        </div>
                    </div>

                    <div class="section-divider"></div>

                    <div class="security-item">
                        <div class="security-info">
                            <h4>Sessions actives</h4>
                            <p>2 appareils connect√©s actuellement</p>
                        </div>
                        <div class="security-status">
                            <button class="btn btn-outline btn-sm" onclick="openSessionsModal()">
                                <i class="fas fa-desktop"></i> G√©rer
                            </button>
                        </div>
                    </div>

                    <div class="section-divider"></div>

                    <div class="security-item">
                        <div class="security-info">
                            <h4>Export des donn√©es</h4>
                            <p>T√©l√©chargez une copie de vos donn√©es</p>
                        </div>
                        <div class="security-status">
                            <button class="btn btn-outline btn-sm" onclick="openExportModal()">
                                <i class="fas fa-download"></i> Exporter
                            </button>
                        </div>
                    </div>

                    <div class="section-divider"></div>

                    <div class="security-item">
                        <div class="security-info">
                            <h4>D√©connexion</h4>
                            <p>Se d√©connecter de votre compte</p>
                        </div>
                        <div class="security-status">
                            <button class="btn btn-warning btn-sm" onclick="logout()">
                                <i class="fas fa-sign-out-alt"></i> Se d√©connecter
                            </button>
                        </div>
                    </div>

                    <div class="security-item">
                        <div class="security-info">
                            <h4>Suppression du compte</h4>
                            <p>Supprimer d√©finitivement votre compte</p>
                        </div>
                        <div class="security-status">
                            <button class="btn btn-danger btn-sm" onclick="openDeleteModal()">
                                <i class="fas fa-trash"></i> Supprimer
                            </button>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <!-- Modal de changement de mot de passe -->
    <div id="password-change-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-key"></i> Changer le mot de passe</h3>
                <button class="modal-close" onclick="closePasswordModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="password-change-form">
                    <div class="form-group">
                        <label for="current-password">Mot de passe actuel</label>
                        <input type="password" id="current-password" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="new-password">Nouveau mot de passe</label>
                        <input type="password" id="new-password" class="form-control" required minlength="8">
                        <small class="form-text">Minimum 8 caract√®res</small>
                    </div>
                    <div class="form-group">
                        <label for="confirm-password">Confirmer le nouveau mot de passe</label>
                        <input type="password" id="confirm-password" class="form-control" required>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closePasswordModal()">Annuler</button>
                <button type="button" class="btn btn-primary" onclick="changePassword()">Changer le mot de passe</button>
            </div>
        </div>
    </div>

    <!-- Modal 2FA -->
    <div id="2fa-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-mobile-alt"></i> Authentification √† deux facteurs</h3>
                <button class="modal-close" onclick="close2FAModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div id="2fa-setup" style="display: block;">
                    <p>L'authentification √† deux facteurs ajoute une couche de s√©curit√© suppl√©mentaire √† votre compte.</p>
                    <div class="form-group">
                        <label for="phone-2fa">Num√©ro de t√©l√©phone</label>
                        <input type="tel" id="phone-2fa" class="form-control" placeholder="+212 6 12 34 56 78" required>
                    </div>
                    <div class="form-group">
                        <label for="2fa-method">M√©thode d'authentification</label>
                        <select id="2fa-method" class="form-control">
                            <option value="sms">SMS</option>
                            <option value="email">Email</option>
                            <option value="app">Application d'authentification</option>
                        </select>
                    </div>
                </div>
                <div id="2fa-verify" style="display: none;">
                    <p>Entrez le code de v√©rification envoy√© √† votre t√©l√©phone :</p>
                    <div class="form-group">
                        <label for="2fa-code">Code de v√©rification</label>
                        <input type="text" id="2fa-code" class="form-control" placeholder="123456" maxlength="6" required>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="close2FAModal()">Annuler</button>
                <button type="button" class="btn btn-primary" id="2fa-action-btn" onclick="setup2FA()">Activer 2FA</button>
            </div>
        </div>
    </div>

    <!-- Modal Sessions Actives -->
    <div id="sessions-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-desktop"></i> Sessions Actives</h3>
                <button class="modal-close" onclick="closeSessionsModal()">&times;</button>
            </div>
            <div class="modal-body">
                <p>G√©rez les appareils connect√©s √† votre compte :</p>
                <div id="sessions-list">
                    <div class="session-item">
                        <div class="session-info">
                            <i class="fas fa-desktop"></i>
                            <div>
                                <strong>Chrome - Windows</strong>
                                <small>Session actuelle ‚Ä¢ Derni√®re activit√©: maintenant</small>
                            </div>
                        </div>
                        <button class="btn btn-outline btn-sm" onclick="terminateSession(this)" disabled>Actuelle</button>
                    </div>
                    <div class="session-item">
                        <div class="session-info">
                            <i class="fas fa-mobile-alt"></i>
                            <div>
                                <strong>Mobile - Android</strong>
                                <small>Derni√®re activit√©: il y a 2 heures</small>
                            </div>
                        </div>
                        <button class="btn btn-danger btn-sm" onclick="terminateSession(this)">Terminer</button>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeSessionsModal()">Fermer</button>
                <button type="button" class="btn btn-danger" onclick="terminateAllSessions()">Terminer toutes les sessions</button>
            </div>
        </div>
    </div>

    <!-- Modal Export des Donn√©es -->
    <div id="export-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-download"></i> Exporter mes Donn√©es</h3>
                <button class="modal-close" onclick="closeExportModal()">&times;</button>
            </div>
            <div class="modal-body">
                <p>S√©lectionnez les donn√©es que vous souhaitez exporter :</p>
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="export-profile" checked> Informations du profil
                    </label>
                </div>
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="export-analyses" checked> Historique des analyses
                    </label>
                </div>
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="export-settings"> Param√®tres et pr√©f√©rences
                    </label>
                </div>
                <div class="form-group">
                    <label for="export-format">Format d'export :</label>
                    <select id="export-format" class="form-control">
                        <option value="json">JSON</option>
                        <option value="csv">CSV</option>
                        <option value="pdf">PDF</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeExportModal()">Annuler</button>
                <button type="button" class="btn btn-primary" onclick="exportUserData()">Exporter</button>
            </div>
        </div>
    </div>

    <!-- Modal Suppression de Compte -->
    <div id="delete-account-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-exclamation-triangle"></i> Supprimer le Compte</h3>
                <button class="modal-close" onclick="closeDeleteModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="alert alert-warning">
                    <i class="fas fa-exclamation-triangle"></i>
                    <strong>Attention !</strong> Cette action est irr√©versible.
                </div>
                <p>Toutes vos donn√©es seront d√©finitivement supprim√©es :</p>
                <ul>
                    <li>Informations du profil</li>
                    <li>Historique des analyses</li>
                    <li>Param√®tres et pr√©f√©rences</li>
                    <li>Toutes les donn√©es associ√©es</li>
                </ul>
                <div class="form-group">
                    <label for="delete-confirm">Tapez "SUPPRIMER" pour confirmer :</label>
                    <input type="text" id="delete-confirm" class="form-control" placeholder="SUPPRIMER" required>
                </div>
                <div class="form-group">
                    <label for="delete-password">Entrez votre mot de passe :</label>
                    <input type="password" id="delete-password" class="form-control" required>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeDeleteModal()">Annuler</button>
                <button type="button" class="btn btn-danger" onclick="deleteAccount()">Supprimer d√©finitivement</button>
            </div>
        </div>
    </div>

    <script>
        // FONCTION DE NAVIGATION - CHARGEMENT IMM√âDIAT
        window.showSection = function(sectionName) {
            console.log('üîÑ Navigation vers:', sectionName);
            
            // Cacher toutes les sections
            const sections = document.querySelectorAll('.content-section');
            sections.forEach(section => {
                section.style.display = 'none';
            });

            // Afficher la section demand√©e
            const targetSection = document.getElementById(sectionName + '-section');
            if (targetSection) {
                targetSection.style.display = 'block';
                console.log('‚úÖ Section affich√©e:', sectionName);
            } else {
                console.log('‚ùå Section non trouv√©e:', sectionName);
            }
            
            // Mettre √† jour la navigation active
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            const activeItem = document.querySelector(`[onclick*="${sectionName}"]`);
            if (activeItem) {
                activeItem.classList.add('active');
            }
        };
        
        console.log('‚úÖ Fonction showSection charg√©e imm√©diatement');

        // Fonction pour g√©rer le changement de th√®me depuis la configuration
        function handleThemeChange() {
            const themeSelect = document.getElementById('theme-select');
            const selectedTheme = themeSelect.value;
            
            console.log('Changement de th√®me vers:', selectedTheme);
            
            if (window.themeManager) {
                window.themeManager.setTheme(selectedTheme);
                
                // Synchroniser avec le bouton flottant
                const themeToggle = document.getElementById('theme-toggle');
                if (themeToggle) {
                    themeToggle.innerHTML = selectedTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
                }
                
                // Notification de succ√®s
                const message = window.translationManager ? 
                    (window.translationManager.getCurrentLanguage() === 'fr' ? 'Th√®me mis √† jour avec succ√®s !' : 'Theme updated successfully!') :
                    'Th√®me mis √† jour avec succ√®s !';
                showNotification(message, 'success');
            } else {
                console.error('ThemeManager non disponible');
                // Fallback: appliquer directement
                document.body.setAttribute('data-theme', selectedTheme);
                
                const themeToggle = document.getElementById('theme-toggle');
                if (themeToggle) {
                    themeToggle.innerHTML = selectedTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
                }
                
                localStorage.setItem('talentscope_theme', selectedTheme);
                showNotification('Th√®me mis √† jour avec succ√®s !', 'success');
            }
        }

        // Fonction pour g√©rer le changement de langue depuis la configuration
        function handleLanguageChange(selectElement) {
            const selectedLanguage = selectElement.value;
            console.log('Changement de langue vers:', selectedLanguage);
            
            // Utiliser le syst√®me de traduction si disponible
            if (window.directTranslationManager) {
                window.directTranslationManager.changeLanguage(selectedLanguage);
            } else if (window.directTranslation) {
                window.directTranslation.changeLanguage(selectedLanguage);
            } else {
                // Fallback: sauvegarder manuellement et recharger
                localStorage.setItem('language', selectedLanguage);
            }
            
            // Notification de changement
            const message = selectedLanguage === 'fr' ? 'Changement vers le fran√ßais...' : 'Switching to English...';
            showNotification(message, 'info');
            
            // Forcer un rechargement de la page pour appliquer la nouvelle langue
            setTimeout(() => {
                location.reload();
            }, 1000);
        }

        // Fonction d'initialisation au chargement de la page
        // Fonction supprim√©e - remplac√©e par la version compl√®te plus bas

        // Mettre √† jour les informations utilisateur
        function updateUserInfo() {
            const currentUser = window.userDatabase?.getCurrentUser();
            if (currentUser) {
                updateAllUserInfo(currentUser);
            }
        }

        // Charger le profil utilisateur
        function loadUserProfile() {
            const currentUser = window.userDatabase?.getCurrentUser();
            if (currentUser) {
                updateAllUserInfo(currentUser);
            }
        }

        // Fonction pour synchroniser les s√©lecteurs de configuration
        function synchronizeConfigSelectors() {
            // Synchroniser le th√®me
            const themeSelect = document.getElementById('theme-select');
            const currentTheme = localStorage.getItem('theme') || 'light';
            if (themeSelect) {
                themeSelect.value = currentTheme;
            }

            // Synchroniser la langue
            const configLanguageSelect = document.getElementById('config-language-select');
            const currentLanguage = localStorage.getItem('language') || 'fr';
            if (configLanguageSelect) {
                configLanguageSelect.value = currentLanguage;
                console.log('S√©lecteur de langue synchronis√© avec:', currentLanguage);
            }
            
            // S'assurer que le syst√®me de traduction est initialis√©
            if (window.directTranslationManager) {
                window.directTranslationManager.applyTranslations();
            } else if (window.directTranslation) {
                window.directTranslation.applyTranslations();
            }
        }

        // Fonction pour afficher des notifications
        function showNotification(message, type = 'info') {
            // Cr√©er l'√©l√©ment de notification
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.style.cssText = `
                position: fixed;
                top: 100px;
                right: 20px;
                z-index: 1001;
                background: var(--bg-primary);
                border: 1px solid var(--border-primary);
                border-radius: 8px;
                padding: 15px 20px;
                box-shadow: var(--shadow-lg);
                max-width: 300px;
                transform: translateX(100%);
                transition: transform 0.3s ease;
            `;
            
            // Ajouter l'ic√¥ne selon le type
            const icon = type === 'success' ? '<i class="fas fa-check-circle"></i>' : type === 'error' ? '‚ùå' : '‚ÑπÔ∏è';
            notification.innerHTML = `
                <div style="display: flex; align-items: center; gap: 10px;">
                    <span style="font-size: 1.2rem;">${icon}</span>
                    <span style="color: var(--text-primary);">${message}</span>
                </div>
            `;
            
            // Ajouter au DOM
            document.body.appendChild(notification);
            
            // Animer l'entr√©e
            setTimeout(() => {
                notification.style.transform = 'translateX(0)';
            }, 100);
            
            // Supprimer apr√®s 3 secondes
            setTimeout(() => {
                notification.style.transform = 'translateX(100%)';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, 3000);
        }


        function editProfile() {
            showSection('profile');
        }

        // Fonctions pour le changement de mot de passe
        function openPasswordModal() {
            const modal = document.getElementById('password-change-modal');
            modal.style.display = 'flex';
            // Vider les champs
            document.getElementById('current-password').value = '';
            document.getElementById('new-password').value = '';
            document.getElementById('confirm-password').value = '';
        }

        function closePasswordModal() {
            const modal = document.getElementById('password-change-modal');
            modal.style.display = 'none';
        }

        function changePassword() {
            console.log('=== CHANGING PASSWORD ===');
            
            try {
                const currentPassword = document.getElementById('current-password').value;
                const newPassword = document.getElementById('new-password').value;
                const confirmPassword = document.getElementById('confirm-password').value;

                // Validation
                if (!currentPassword) {
                    alert('Veuillez entrer votre mot de passe actuel');
                    return;
                }

                if (!newPassword) {
                    alert('Veuillez entrer un nouveau mot de passe');
                    return;
                }

                if (newPassword.length < 8) {
                    alert('Le nouveau mot de passe doit contenir au moins 8 caract√®res');
                    return;
                }

                if (newPassword !== confirmPassword) {
                    alert('Les nouveaux mots de passe ne correspondent pas');
                    return;
                }

                // V√©rifier le mot de passe actuel
                const currentUser = window.userDatabase?.getCurrentUser();
                if (!currentUser) {
                    alert('Erreur: Utilisateur non connect√©');
                    return;
                }

                if (currentUser.password !== currentPassword) {
                    alert('Le mot de passe actuel est incorrect');
                    return;
                }

                // Mettre √† jour le mot de passe dans la base de donn√©es
                const updatedUser = window.userDatabase.updateCurrentUserProfile({
                    password: newPassword,
                    passwordLastModified: new Date().toISOString()
                });

                if (updatedUser) {
                    console.log('Password updated successfully');
                    alert('Mot de passe chang√© avec succ√®s !');
                    closePasswordModal();
                    // Mettre √† jour l'affichage de la date
                    updatePasswordLastModified();
                } else {
                    alert('Erreur lors du changement de mot de passe');
                }

            } catch (error) {
                console.error('Error changing password:', error);
                alert('Erreur: ' + error.message);
            }
        }

        function updatePasswordLastModified() {
            const currentUser = window.userDatabase?.getCurrentUser();
            if (!currentUser) return;
            
            const lastModifiedElement = document.getElementById('password-last-modified');
            if (!lastModifiedElement) return;
            
            let lastModifiedDate;
            if (currentUser.passwordLastModified) {
                lastModifiedDate = new Date(currentUser.passwordLastModified);
            } else {
                // Si pas de date, utiliser la date de cr√©ation du compte
                lastModifiedDate = new Date(currentUser.createdAt || Date.now());
            }
            
            const now = new Date();
            const diffTime = Math.abs(now - lastModifiedDate);
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            
            let timeText;
            if (diffDays === 0) {
                timeText = "aujourd'hui";
            } else if (diffDays === 1) {
                timeText = "hier";
            } else if (diffDays < 7) {
                timeText = `il y a ${diffDays} jours`;
            } else if (diffDays < 30) {
                const weeks = Math.floor(diffDays / 7);
                timeText = `il y a ${weeks} semaine${weeks > 1 ? 's' : ''}`;
            } else if (diffDays < 365) {
                const months = Math.floor(diffDays / 30);
                timeText = `il y a ${months} mois`;
            } else {
                const years = Math.floor(diffDays / 365);
                timeText = `il y a ${years} an${years > 1 ? 's' : ''}`;
            }
            
            lastModifiedElement.textContent = `Derni√®re modification ${timeText}`;
        }

        // Profile Management Functions
        function uploadProfilePicture() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*';
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (file) {
                    // V√©rifier le type de fichier
                    if (!file.type.startsWith('image/')) {
                        alert('Veuillez s√©lectionner un fichier image valide (JPG, PNG, GIF, etc.)');
                        return;
                    }

                    // V√©rifier la taille du fichier (max 5MB)
                    if (file.size > 5 * 1024 * 1024) {
                        alert('La taille du fichier ne doit pas d√©passer 5MB');
                        return;
                    }

                    // Afficher un indicateur de chargement
                    const avatar = document.getElementById('profile-avatar-large');
                    const originalContent = avatar.innerHTML;
                    avatar.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';

                    const reader = new FileReader();
                    reader.onload = function(e) {
                        const imageData = e.target.result;
                        
                        // Cr√©er une nouvelle image pour valider
                        const img = new Image();
                        img.onload = function() {
                            // V√©rifier les dimensions (optionnel)
                            if (img.width < 100 || img.height < 100) {
                                alert('L\'image doit faire au moins 100x100 pixels');
                                avatar.innerHTML = originalContent;
                                return;
                            }
                            
                            // Mettre √† jour l'affichage avec la nouvelle photo
                            avatar.innerHTML = `<img src="${imageData}" alt="Photo de profil">`;
                            
                            // Mettre √† jour l'avatar dans la sidebar
                            const sidebarAvatar = document.getElementById('sidebar-profile-avatar');
                            if (sidebarAvatar) {
                                sidebarAvatar.innerHTML = `<img src="${imageData}" alt="Photo de profil">`;
                            }
                            
                            // Sauvegarder dans la base de donn√©es
                            const currentUser = window.userDatabase?.getCurrentUser();
                            if (currentUser) {
                                const updatedUser = window.userDatabase.updateCurrentUserProfile({
                                    profilePicture: imageData
                                });
                                if (updatedUser) {
                                    console.log('Photo de profil mise √† jour avec succ√®s');
                                    // Afficher un message de succ√®s temporaire
                                    showTemporaryMessage('Photo de profil mise √† jour !', 'success');
                                }
                            }
                        };
                        img.onerror = function() {
                            alert('Erreur lors du chargement de l\'image');
                            avatar.innerHTML = originalContent;
                        };
                        img.src = imageData;
                    };
                    reader.onerror = function() {
                        alert('Erreur lors de la lecture du fichier');
                        avatar.innerHTML = originalContent;
                    };
                    reader.readAsDataURL(file);
                }
            };
            input.click();
        }

        function removeProfilePicture() {
            if (confirm('Voulez-vous vraiment supprimer votre photo de profil ?')) {
                const avatar = document.getElementById('profile-avatar-large');
                avatar.innerHTML = '<i class="fas fa-user"></i>';
                
                // Mettre √† jour l'avatar dans la sidebar
                const sidebarAvatar = document.getElementById('sidebar-profile-avatar');
                if (sidebarAvatar) {
                    sidebarAvatar.innerHTML = '<i class="fas fa-user"></i>';
                }
                
                // Supprimer de la base de donn√©es
                const currentUser = window.userDatabase?.getCurrentUser();
                if (currentUser) {
                    const updatedUser = window.userDatabase.updateCurrentUserProfile({
                        profilePicture: null
                    });
                    if (updatedUser) {
                        console.log('Photo de profil supprim√©e');
                        showTemporaryMessage('Photo de profil supprim√©e !', 'info');
                    }
                }
            }
        }

        function showTemporaryMessage(message, type = 'info') {
            // Cr√©er un √©l√©ment de message temporaire
            const messageDiv = document.createElement('div');
            messageDiv.className = `temp-message temp-message-${type}`;
            messageDiv.textContent = message;
            messageDiv.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 12px 20px;
                border-radius: 8px;
                color: white;
                font-weight: 500;
                z-index: 10000;
                animation: slideIn 0.3s ease-out;
                max-width: 300px;
            `;
            
            // Styles selon le type
            if (type === 'success') {
                messageDiv.style.background = '#10b981';
            } else if (type === 'error') {
                messageDiv.style.background = '#ef4444';
            } else {
                messageDiv.style.background = '#3b82f6';
            }
            
            document.body.appendChild(messageDiv);
            
            // Supprimer apr√®s 3 secondes
            setTimeout(() => {
                messageDiv.style.animation = 'slideOut 0.3s ease-in';
                setTimeout(() => {
                    if (messageDiv.parentNode) {
                        messageDiv.parentNode.removeChild(messageDiv);
                    }
                }, 300);
            }, 3000);
        }

        function resetProfileForm() {
            document.getElementById('profile-form').reset();
            document.getElementById('full-name').value = 'Akjouj Hamza';
            document.getElementById('email').value = 'akjouj17@gmail.com';
            document.getElementById('department').value = 'development';
            document.getElementById('position').value = 'D√©veloppeur Senior';
            document.getElementById('phone').value = '+212 6 12 34 56 78';
        }


        function enable2FA() {
            if (confirm('Voulez-vous vraiment activer l\'authentification √† deux facteurs ?')) {
                alert('Authentification √† deux facteurs activ√©e !');
                // Ici vous pourriez ajouter la logique pour activer la 2FA
            }
        }

        // Fonctions pour l'authentification √† deux facteurs
        function open2FAModal() {
            const modal = document.getElementById('2fa-modal');
            modal.style.display = 'flex';
            document.getElementById('2fa-setup').style.display = 'block';
            document.getElementById('2fa-verify').style.display = 'none';
            document.getElementById('2fa-action-btn').textContent = 'Activer 2FA';
        }

        function close2FAModal() {
            const modal = document.getElementById('2fa-modal');
            modal.style.display = 'none';
        }

        function setup2FA() {
            const phone = document.getElementById('phone-2fa').value;
            const method = document.getElementById('2fa-method').value;
            
            if (!phone) {
                alert('Veuillez entrer un num√©ro de t√©l√©phone');
                return;
            }

            // Simuler l'envoi du code
            const code = Math.floor(100000 + Math.random() * 900000);
            console.log('Code 2FA g√©n√©r√©:', code);
            
            // Passer √† l'√©tape de v√©rification
            document.getElementById('2fa-setup').style.display = 'none';
            document.getElementById('2fa-verify').style.display = 'block';
            document.getElementById('2fa-action-btn').textContent = 'V√©rifier le code';
            document.getElementById('2fa-action-btn').onclick = verify2FA;
            
            // Stocker le code temporairement
            window.temp2FACode = code;
            
            alert(`Code de v√©rification envoy√©: ${code} (simulation)`);
        }

        function verify2FA() {
            const enteredCode = document.getElementById('2fa-code').value;
            const correctCode = window.temp2FACode;
            
            if (enteredCode === correctCode.toString()) {
                // Activer la 2FA dans la base de donn√©es
                const currentUser = window.userDatabase?.getCurrentUser();
                if (currentUser) {
                    const updatedUser = window.userDatabase.updateCurrentUserProfile({
                        twoFactorEnabled: true,
                        twoFactorMethod: document.getElementById('2fa-method').value,
                        twoFactorPhone: document.getElementById('phone-2fa').value
                    });
                    
                    if (updatedUser) {
                        alert('Authentification √† deux facteurs activ√©e avec succ√®s !');
                        close2FAModal();
                        // Mettre √† jour l'affichage
                        update2FAStatus(true);
                    }
                }
            } else {
                alert('Code de v√©rification incorrect');
            }
        }

        function update2FAStatus(enabled) {
            const statusBadge = document.querySelector('.security-item:nth-child(3) .status-badge');
            const actionButton = document.querySelector('.security-item:nth-child(3) .btn');
            
            if (enabled) {
                statusBadge.textContent = 'Activ√©';
                statusBadge.className = 'status-badge status-active';
                actionButton.textContent = 'D√©sactiver';
                actionButton.className = 'btn btn-danger btn-sm';
                actionButton.onclick = disable2FA;
            }
        }

        function disable2FA() {
            if (confirm('Voulez-vous vraiment d√©sactiver l\'authentification √† deux facteurs ?')) {
                const currentUser = window.userDatabase?.getCurrentUser();
                if (currentUser) {
                    const updatedUser = window.userDatabase.updateCurrentUserProfile({
                        twoFactorEnabled: false
                    });
                    
                    if (updatedUser) {
                        alert('Authentification √† deux facteurs d√©sactiv√©e');
                        update2FAStatus(false);
                    }
                }
            }
        }

        // Fonctions pour la gestion des sessions
        function openSessionsModal() {
            const modal = document.getElementById('sessions-modal');
            modal.style.display = 'flex';
        }

        function closeSessionsModal() {
            const modal = document.getElementById('sessions-modal');
            modal.style.display = 'none';
        }

        function terminateSession(button) {
            const sessionItem = button.closest('.session-item');
            if (confirm('Voulez-vous vraiment terminer cette session ?')) {
                sessionItem.remove();
                alert('Session termin√©e avec succ√®s');
            }
        }

        function terminateAllSessions() {
            if (confirm('Voulez-vous vraiment terminer toutes les sessions sauf la session actuelle ?')) {
                const sessions = document.querySelectorAll('.session-item:not(:first-child)');
                sessions.forEach(session => session.remove());
                alert('Toutes les sessions ont √©t√© termin√©es');
            }
        }

        // Fonctions pour l'export des donn√©es
        function openExportModal() {
            const modal = document.getElementById('export-modal');
            modal.style.display = 'flex';
        }

        function closeExportModal() {
            const modal = document.getElementById('export-modal');
            modal.style.display = 'none';
        }

        function exportUserData() {
            const currentUser = window.userDatabase?.getCurrentUser();
            if (!currentUser) {
                alert('Erreur: Utilisateur non connect√©');
                return;
            }

            const exportData = {};
            const format = document.getElementById('export-format').value;

            if (document.getElementById('export-profile').checked) {
                exportData.profile = {
                    fullName: currentUser.fullName,
                    email: currentUser.email,
                    department: currentUser.department,
                    position: currentUser.position,
                    phone: currentUser.phone,
                    createdAt: currentUser.createdAt
                };
            }

            if (document.getElementById('export-analyses').checked) {
                exportData.analyses = JSON.parse(localStorage.getItem('analysisHistory') || '[]');
            }

            if (document.getElementById('export-settings').checked) {
                exportData.settings = {
                    theme: localStorage.getItem('theme') || 'light',
                    language: localStorage.getItem('lang') || 'fr'
                };
            }

            // Cr√©er et t√©l√©charger le fichier
            const dataStr = JSON.stringify(exportData, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `talentScope_data_${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            URL.revokeObjectURL(url);

            alert('Donn√©es export√©es avec succ√®s !');
            closeExportModal();
        }

        // Fonctions pour la suppression de compte
        function openDeleteModal() {
            const modal = document.getElementById('delete-account-modal');
            modal.style.display = 'flex';
            document.getElementById('delete-confirm').value = '';
            document.getElementById('delete-password').value = '';
        }

        function closeDeleteModal() {
            const modal = document.getElementById('delete-account-modal');
            modal.style.display = 'none';
        }

        function deleteAccount() {
            const confirmText = document.getElementById('delete-confirm').value;
            const password = document.getElementById('delete-password').value;
            const currentUser = window.userDatabase?.getCurrentUser();

            if (confirmText !== 'SUPPRIMER') {
                alert('Veuillez taper "SUPPRIMER" pour confirmer');
                return;
            }

            if (!password) {
                alert('Veuillez entrer votre mot de passe');
                return;
            }

            if (currentUser && currentUser.password !== password) {
                alert('Mot de passe incorrect');
                return;
            }

            if (confirm('√ätes-vous ABSOLUMENT S√õR de vouloir supprimer votre compte ? Cette action est irr√©versible !')) {
                // Supprimer l'utilisateur de la base de donn√©es
                const users = window.userDatabase.getAllUsers();
                delete users[currentUser.id];
                window.userDatabase.saveAllUsers(users);
                
                // D√©connecter l'utilisateur
                window.userDatabase.logout();
                
                alert('Compte supprim√© avec succ√®s. Vous allez √™tre redirig√© vers la page de connexion.');
                window.location.href = '/auth';
            }
        }

        function changeLanguage() {
            const languages = ['Fran√ßais', 'English', 'Espa√±ol'];
            const currentLang = 'Fran√ßais';
            const newLang = prompt(`Langue actuelle: ${currentLang}\nNouvelles langues disponibles: ${languages.join(', ')}`);
            if (newLang && languages.includes(newLang)) {
                console.log(`Langue chang√©e vers ${newLang}`);
            }
        }

        // Handle profile form submission
        document.addEventListener('DOMContentLoaded', function() {
            // V√©rifier l'√©tat de connexion
            const isLoggedIn = localStorage.getItem('isLoggedIn') || sessionStorage.getItem('isLoggedIn');
            const userEmail = localStorage.getItem('userEmail') || sessionStorage.getItem('userEmail');
            
            if (!isLoggedIn || !userEmail) {
                console.log('‚ùå Utilisateur non connect√©, redirection vers l\'authentification');
                window.location.href = '/auth';
                return;
            }
            
            console.log('‚úÖ Utilisateur connect√©:', userEmail);
            
            const profileForm = document.getElementById('profile-form');
            if (profileForm) {
                profileForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    updateUserProfile();
                });
            }
            
            // Initialiser le th√®me
            initializeTheme();
            
            // Initialiser l'application
            initializeApp();
            
            // Initialiser des donn√©es de test si n√©cessaire
            console.log('üß™ Initialisation des donn√©es de test...');
            initializeTestData();
            
            // Afficher les graphiques instantan√©ment
            showChartsInstantly();
            
            // Forcer la mise √† jour imm√©diate
            setTimeout(() => {
                forceDashboardUpdate();
            }, 500);
            
            // V√©rifier si le dashboard a besoin d'√™tre mis √† jour
            checkForDashboardUpdate();
            
            // V√©rifier les param√®tres d'URL pour forcer la mise √† jour
            const urlParams = new URLSearchParams(window.location.search);
            if (urlParams.get('refresh') || urlParams.get('analysis')) {
                console.log('Param√®tres d\'URL d√©tect√©s, for√ßage de la mise √† jour');
                localStorage.setItem('forceDashboardRefresh', 'true');
                checkForDashboardUpdate();
            }
            
            // V√©rifier p√©riodiquement les mises √† jour
            setInterval(checkForDashboardUpdate, 2000);
        });

        // Fonction pour initialiser des donn√©es de test
        function initializeTestData() {
            console.log('=== INITIALISATION DES DONN√âES DE TEST ===');
            
            // V√©rifier si des donn√©es existent d√©j√†
            const existingHistory = JSON.parse(localStorage.getItem('analysisHistory') || '[]');
            const existingStats = JSON.parse(localStorage.getItem('dashboardStats') || '{}');
            
            console.log('Historique existant:', existingHistory.length, 'analyses');
            console.log('Statistiques existantes:', existingStats);
            
            // Cr√©er des donn√©es de test si n√©cessaire (forcer la cr√©ation)
            if (existingHistory.length === 0 || Object.keys(existingStats).length === 0) {
                console.log('Aucune donn√©e trouv√©e, cr√©ation de donn√©es de test...');
                
                // Cr√©er des analyses de test
                const testAnalyses = [
                    {
                        id: 'test_1',
                        timestamp: new Date(Date.now() - 2 * 24 * 60 * 60 * 1000).toISOString(), // 2 jours
                        jobOffer: {
                            jobTitle: 'D√©veloppeur Full Stack',
                            department: 'informatique',
                            jobDescription: 'D√©veloppement d\'applications web modernes',
                            requiredExperience: '2-5'
                        },
                        weights: {
                            formation: 25,
                            experience: 30,
                            competences: 25,
                            langues: 20
                        },
                        results: [
                            { name: 'Jean Dupont', totalScore: 92.5, formationScore: 90, experienceScore: 95, competencesScore: 92, languesScore: 93 },
                            { name: 'Marie Martin', totalScore: 87.2, formationScore: 85, experienceScore: 88, competencesScore: 87, languesScore: 89 },
                            { name: 'Pierre Durand', totalScore: 79.8, formationScore: 78, experienceScore: 82, competencesScore: 79, languesScore: 80 }
                        ],
                        totalCVs: 3,
                        averageScore: 86.5,
                        bestScore: 92.5,
                        worstScore: 79.8
                    },
                    {
                        id: 'test_2',
                        timestamp: new Date(Date.now() - 5 * 24 * 60 * 60 * 1000).toISOString(), // 5 jours
                        jobOffer: {
                            jobTitle: 'Data Scientist',
                            department: 'informatique',
                            jobDescription: 'Analyse de donn√©es et machine learning',
                            requiredExperience: '3-7'
                        },
                        weights: {
                            formation: 30,
                            experience: 35,
                            competences: 25,
                            langues: 10
                        },
                        results: [
                            { name: 'Sophie Leroy', totalScore: 92.3, formationScore: 95, experienceScore: 90, competencesScore: 92, languesScore: 92 },
                            { name: 'Thomas Moreau', totalScore: 88.7, formationScore: 85, experienceScore: 92, competencesScore: 88, languesScore: 90 },
                            { name: 'Julie Petit', totalScore: 81.4, formationScore: 80, experienceScore: 85, competencesScore: 80, languesScore: 81 }
                        ],
                        totalCVs: 3,
                        averageScore: 87.5,
                        bestScore: 92.3,
                        worstScore: 81.4
                    },
                    {
                        id: 'test_3',
                        timestamp: new Date(Date.now() - 7 * 24 * 60 * 60 * 1000).toISOString(), // 1 semaine
                        jobOffer: {
                            jobTitle: 'Chef de Projet IT',
                            department: 'informatique',
                            jobDescription: 'Gestion de projets informatiques',
                            requiredExperience: '5-10'
                        },
                        weights: {
                            formation: 20,
                            experience: 40,
                            competences: 25,
                            langues: 15
                        },
                        results: [
                            { name: 'Marc Dubois', totalScore: 89.2, formationScore: 85, experienceScore: 95, competencesScore: 88, languesScore: 89 },
                            { name: 'Nathalie Blanc', totalScore: 83.6, formationScore: 80, experienceScore: 88, competencesScore: 82, languesScore: 85 }
                        ],
                        totalCVs: 2,
                        averageScore: 86.4,
                        bestScore: 89.2,
                        worstScore: 83.6
                    }
                ];
                
                // Sauvegarder les analyses de test
                localStorage.setItem('analysisHistory', JSON.stringify(testAnalyses));
                console.log('Analyses de test cr√©√©es:', testAnalyses.length);
                
                // Calculer les statistiques du dashboard
                const totalAnalyses = testAnalyses.length;
                const totalCVs = testAnalyses.reduce((sum, analysis) => sum + analysis.totalCVs, 0);
                const allScores = testAnalyses.flatMap(analysis => analysis.results.map(result => result.totalScore));
                const averageScore = allScores.reduce((sum, score) => sum + score, 0) / allScores.length;
                const successRate = (allScores.filter(score => score >= 70).length / allScores.length) * 100;
                
                // Statistiques de la semaine (derni√®re semaine)
                const oneWeekAgo = new Date(Date.now() - 7 * 24 * 60 * 60 * 1000);
                const weekAnalyses = testAnalyses.filter(analysis => new Date(analysis.timestamp) >= oneWeekAgo);
                const weekCVs = weekAnalyses.reduce((sum, analysis) => sum + analysis.totalCVs, 0);
                
                const dashboardStats = {
                    totalAnalyses: totalAnalyses,
                    totalCVs: totalCVs,
                    averageScore: 82.3, // Score moyen r√©aliste
                    successRate: 87.5, // Taux de r√©ussite r√©aliste
                    weekAnalyses: weekAnalyses.length,
                    weekCVs: weekCVs,
                    weekScoreChange: 3.2, // Am√©lioration r√©aliste
                    weekSuccessChange: 2.1 // Am√©lioration r√©aliste
                };
                
                // Sauvegarder les statistiques
                localStorage.setItem('dashboardStats', JSON.stringify(dashboardStats));
                console.log('Statistiques du dashboard cr√©√©es:', dashboardStats);
                
                // Forcer la mise √† jour
                localStorage.setItem('forceDashboardRefresh', 'true');
                
                console.log('=== DONN√âES DE TEST INITIALIS√âES ===');
            } else {
                console.log('Donn√©es existantes trouv√©es, pas de donn√©es de test cr√©√©es');
            }
        }

        // Fonction pour v√©rifier si le dashboard a besoin d'√™tre mis √† jour
        function checkForDashboardUpdate() {
            const needsUpdate = localStorage.getItem('dashboardNeedsUpdate');
            const lastAnalysisId = localStorage.getItem('lastAnalysisId');
            const forceRefresh = localStorage.getItem('forceDashboardRefresh');
            
            if (needsUpdate === 'true' || forceRefresh === 'true') {
                console.log('=== MISE √Ä JOUR DU DASHBOARD D√âTECT√âE ===');
                console.log('Needs Update:', needsUpdate);
                console.log('Force Refresh:', forceRefresh);
                console.log('Last Analysis ID:', lastAnalysisId);
                
                // Recharger l'historique
                loadHistoryFromStorage();
                console.log('Historique recharg√©');
                
                // Mettre √† jour les m√©triques
                updateRealMetrics();
                console.log('M√©triques mises √† jour');
                
                // Marquer comme mis √† jour
                localStorage.removeItem('dashboardNeedsUpdate');
                localStorage.removeItem('lastAnalysisId');
                localStorage.removeItem('forceDashboardRefresh');
                
                // Afficher une notification
                showNotification('Dashboard mis √† jour avec la derni√®re analyse !', 'success');
                
                console.log('=== DASHBOARD MIS √Ä JOUR AVEC SUCC√àS ===');
            }
        }

        // Fonction pour afficher une notification
        function showNotification(message, type = 'info') {
            // Cr√©er l'√©l√©ment de notification
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${type === 'success' ? '#10b981' : type === 'error' ? '#ef4444' : '#3b82f6'};
                color: white;
                padding: 15px 20px;
                border-radius: 8px;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
                z-index: 10000;
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                font-size: 14px;
                font-weight: 500;
                max-width: 300px;
                animation: slideInRight 0.3s ease-out;
            `;
            
            notification.innerHTML = `
                <div style="display: flex; align-items: center; gap: 10px;">
                    <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'}"></i>
                    <span>${message}</span>
                </div>
            `;
            
            // Ajouter l'animation CSS
            const style = document.createElement('style');
            style.textContent = `
                @keyframes slideInRight {
                    from {
                        transform: translateX(100%);
                        opacity: 0;
                    }
                    to {
                        transform: translateX(0);
                        opacity: 1;
                    }
                }
                @keyframes slideOutRight {
                    from {
                        transform: translateX(0);
                        opacity: 1;
                    }
                    to {
                        transform: translateX(100%);
                        opacity: 0;
                    }
                }
            `;
            document.head.appendChild(style);
            
            // Ajouter au DOM
            document.body.appendChild(notification);
            
            // Supprimer apr√®s 4 secondes
            setTimeout(() => {
                notification.style.animation = 'slideOutRight 0.3s ease-in';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, 4000);
        }

        // Function to save profile changes - SIMPLIFIED VERSION
        function saveProfileChanges() {
            console.log('=== SAVE PROFILE CHANGES STARTED ===');
            
            try {
                // V√©rifier si la base de donn√©es existe
                if (!window.userDatabase) {
                    alert('Erreur: Base de donn√©es non disponible');
                    return;
                }

                const currentUser = window.userDatabase.getCurrentUser();
                if (!currentUser) {
                    alert('Erreur: Utilisateur non connect√©');
                    return;
                }

                console.log('Current user:', currentUser);

                // R√©cup√©rer les valeurs du formulaire
                const fullName = document.getElementById('full-name')?.value?.trim() || '';
                const email = document.getElementById('email')?.value?.trim() || '';
                const department = document.getElementById('department')?.value || '';
                const position = document.getElementById('position')?.value?.trim() || '';
                const phone = document.getElementById('phone')?.value?.trim() || '';

                console.log('Form data retrieved:', { fullName, email, department, position, phone });

                // Validation
                if (!fullName) {
                    alert('Le nom complet est obligatoire');
                    return;
                }
                if (!email) {
                    alert('L\'email est obligatoire');
                    return;
                }

                // Pr√©parer les donn√©es
                const profileData = {
                    fullName: fullName,
                    email: email,
                    department: department,
                    position: position,
                    phone: phone
                };

                console.log('Saving profile data:', profileData);

                // Sauvegarder dans la base de donn√©es
                const updatedUser = window.userDatabase.updateCurrentUserProfile(profileData);
                
                if (updatedUser) {
                    console.log('User updated successfully:', updatedUser);
                    
                    // Mettre √† jour l'interface imm√©diatement
                    updateAllUserInfo(updatedUser);
                    
                    // Afficher le message de succ√®s
                    alert('Profil mis √† jour avec succ√®s !');
                    
                    console.log('=== SAVE PROFILE CHANGES COMPLETED ===');
                } else {
                    console.error('Failed to update user');
                    alert('Erreur lors de la mise √† jour du profil');
                }
                
            } catch (error) {
                console.error('Error in saveProfileChanges:', error);
                alert('Erreur: ' + error.message);
            }
        }

        // Function to update user profile in database (legacy)
        function updateUserProfile() {
            saveProfileChanges();
        }

        // Test function to verify database functionality
        function testDatabase() {
            console.log('=== TESTING DATABASE ===');
            console.log('userDatabase exists:', !!window.userDatabase);
            console.log('Current user:', window.userDatabase?.getCurrentUser());
            console.log('All users:', window.userDatabase?.getAllUsers());
            console.log('=== DATABASE TEST COMPLETE ===');
        }

        // Make test function globally available
        window.testDatabase = testDatabase;

        // Function to update all user info across the entire site
        function updateAllUserInfo(user) {
            console.log('Updating all user info with:', user);
            
            // Mettre √† jour la sidebar
            const sidebarName = document.getElementById('user-fullname');
            const sidebarRole = document.getElementById('user-role');
            if (sidebarName) {
                sidebarName.textContent = user.fullName;
                console.log('Sidebar name updated to:', user.fullName);
            }
            if (sidebarRole) {
                sidebarRole.textContent = user.department;
                console.log('Sidebar role updated to:', user.department);
            }

            // Mettre √† jour la section profil
            const profileName = document.getElementById('profile-name');
            const profileRole = document.getElementById('profile-role');
            if (profileName) {
                profileName.textContent = user.fullName;
                console.log('Profile name updated to:', user.fullName);
            }
            if (profileRole) {
                profileRole.textContent = user.position;
                console.log('Profile role updated to:', user.position);
            }

            // Mettre √† jour les champs du formulaire
            const fullNameField = document.getElementById('full-name');
            const emailField = document.getElementById('email');
            const departmentField = document.getElementById('department');
            const positionField = document.getElementById('position');
            const phoneField = document.getElementById('phone');
            
            if (fullNameField) fullNameField.value = user.fullName;
            if (emailField) emailField.value = user.email;
            if (departmentField) departmentField.value = user.department;
            if (positionField) positionField.value = user.position;
            if (phoneField) phoneField.value = user.phone || '';

            // Mettre √† jour l'avatar si une photo existe
            if (user.profilePicture) {
                const sidebarAvatar = document.getElementById('sidebar-profile-avatar');
                const mainAvatar = document.getElementById('profile-avatar-large');
                if (sidebarAvatar) sidebarAvatar.innerHTML = `<img src="${user.profilePicture}" alt="Photo de profil">`;
                if (mainAvatar) mainAvatar.innerHTML = `<img src="${user.profilePicture}" alt="Photo de profil">`;
            } else {
                // Si pas de photo, afficher l'ic√¥ne par d√©faut
                const sidebarAvatar = document.getElementById('sidebar-profile-avatar');
                const mainAvatar = document.getElementById('profile-avatar-large');
                if (sidebarAvatar) sidebarAvatar.innerHTML = '<i class="fas fa-user"></i>';
                if (mainAvatar) mainAvatar.innerHTML = '<i class="fas fa-user"></i>';
            }

            console.log('Informations utilisateur mises √† jour dans tout le site');
        }

        // Function to update profile display
        function updateProfileDisplay() {
            const currentUser = window.userDatabase?.getCurrentUser();
            if (currentUser) {
                document.getElementById('profile-name').textContent = currentUser.fullName;
                document.getElementById('profile-role').textContent = currentUser.position;
                
                // Update form fields
                document.getElementById('full-name').value = currentUser.fullName;
                document.getElementById('email').value = currentUser.email;
                document.getElementById('department').value = currentUser.department;
                document.getElementById('position').value = currentUser.position;
                document.getElementById('phone').value = currentUser.phone || '';
            }
        }

        function viewSettings() {
            showSection('config');
            document.getElementById('profileDropdown').classList.remove('show');
        }

        function logout() {
            if (confirm('√ätes-vous s√ªr de vouloir vous d√©connecter ?')) {
                window.location.href = '/auth';
            }
            document.getElementById('profileDropdown').classList.remove('show');
        }

        // Close dropdown when clicking outside
        document.addEventListener('click', function(event) {
            const dropdown = document.getElementById('profileDropdown');
            const userInfo = document.querySelector('.user-info');
            
            if (!userInfo.contains(event.target)) {
                dropdown.classList.remove('show');
            }
        });

        // Donn√©es d'historique (simul√©es)
        let analysisHistory = [
            {
                name: 'cv_Hamza.pdf',
                score: 91.3,
                status: 'Excellent',
                statusClass: 'excellent',
                position: 'Data Scientist',
                date: '18/09/2024'
            },
            {
                name: 'cv_Sophia.pdf',
                score: 76.1,
                status: 'Tr√®s bon',
                statusClass: 'very-good',
                position: 'D√©veloppeur Python',
                date: '17/09/2024'
            },
            {
                name: 'cv_Adam.pdf',
                score: 85.2,
                status: 'Excellent',
                statusClass: 'excellent',
                position: 'Analyste Data',
                date: '16/09/2024'
            },
            {
                name: 'cv_Ali.pdf',
                score: 72.8,
                status: 'Bon',
                statusClass: 'good',
                position: 'Ing√©nieur ML',
                date: '15/09/2024'
            }
        ];

        // Fonctions de gestion de l'historique et de la r√©initialisation
        function clearHistory() {
            if (confirm('<i class="fas fa-exclamation-triangle"></i> √ätes-vous s√ªr de vouloir supprimer tout l\'historique des analyses ?\n\nCette action est irr√©versible et supprimera :\n‚Ä¢ Toutes les analyses pr√©c√©dentes\n‚Ä¢ L\'historique des CVs trait√©s\n‚Ä¢ Les statistiques et m√©triques\n\nVoulez-vous continuer ?')) {
                // Vider le tableau d'historique
                analysisHistory = [];
                
                // Supprimer les donn√©es du localStorage
                localStorage.removeItem('talentScope_history');
                localStorage.removeItem('talentScope_analyses');
                localStorage.removeItem('talentScope_statistics');
                localStorage.removeItem('talentScope_metrics');
                
                // Sauvegarder l'historique vide
                localStorage.setItem('talentScope_history', JSON.stringify(analysisHistory));
                
                // Mettre √† jour l'affichage du tableau
                updateHistoryTable();
                
                // Mettre √† jour les m√©triques du dashboard
                updateRealMetrics();
                
                // Mettre √† jour les graphiques
                initializeCharts();
                
                // Afficher une notification de succ√®s
                showNotification('<i class="fas fa-check-circle"></i> Historique supprim√© avec succ√®s', 'success');
            }
        }
        
        // Fonction pour d√©terminer le statut bas√© sur le score
        function getStatusFromScore(score) {
            if (score >= 90) {
                return { text: 'Excellent', class: 'excellent' };
            } else if (score >= 80) {
                return { text: 'Tr√®s bon', class: 'very-good' };
            } else if (score >= 70) {
                return { text: 'Bon', class: 'good' };
            } else if (score >= 60) {
                return { text: 'Moyen', class: 'average' };
            } else {
                return { text: 'Faible', class: 'poor' };
            }
        }
        
        function updateHistoryTable() {
            console.log('=== MISE √Ä JOUR DU TABLEAU D\'HISTORIQUE ===');
            console.log('Analysis History:', analysisHistory);
            console.log('Nombre d\'analyses:', analysisHistory.length);
            
            const tbody = document.querySelector('#processed-section .analysis-table tbody');
            if (!tbody) {
                console.error('√âl√©ment tbody non trouv√© dans #processed-section .analysis-table');
                return;
            }
            
            console.log('√âl√©ment tbody trouv√©:', tbody);
            
            if (analysisHistory.length === 0) {
                console.log('Aucun historique trouv√©, affichage du message vide');
                tbody.innerHTML = `
                    <tr>
                        <td colspan="6" style="text-align: center; padding: 40px; color: #6B7280; font-style: italic;">
                            <i class="fas fa-inbox"></i> Aucun historique d'analyse disponible
                        </td>
                    </tr>
                `;
            } else {
                console.log('Affichage de', analysisHistory.length, 'analyses');
                // Cr√©er une liste de tous les CVs de toutes les analyses
                let allCVs = [];
                analysisHistory.forEach((analysis, analysisIndex) => {
                    if (analysis.results && Array.isArray(analysis.results)) {
                        analysis.results.forEach((cv, cvIndex) => {
                            const date = new Date(analysis.timestamp).toLocaleDateString('fr-FR');
                            const time = new Date(analysis.timestamp).toLocaleTimeString('fr-FR', { hour: '2-digit', minute: '2-digit' });
                            const jobTitle = analysis.jobOffer ? analysis.jobOffer.jobTitle : 'Poste non sp√©cifi√©';
                            
                            allCVs.push({
                                name: cv.name || `CV_${analysisIndex + 1}_${cvIndex + 1}`,
                                score: cv.totalScore || 0,
                                status: getStatusFromScore(cv.totalScore || 0),
                                position: jobTitle,
                                date: `${date} ${time}`,
                                analysisId: analysis.id
                            });
                        });
                    }
                });
                
                // Trier par score d√©croissant
                allCVs.sort((a, b) => b.score - a.score);
                
                console.log('CVs √† afficher:', allCVs);
                
                if (allCVs.length === 0) {
                    tbody.innerHTML = `
                        <tr>
                            <td colspan="6" style="text-align: center; padding: 40px; color: #6B7280; font-style: italic;">
                                <i class="fas fa-inbox"></i> Aucun CV analys√© disponible
                            </td>
                    </tr>
                    `;
                } else {
                    tbody.innerHTML = allCVs.map((cv, index) => {
                        return `
                            <tr>
                                <td>${cv.name}</td>
                                <td>${cv.score.toFixed(1)}%</td>
                                <td><span class="status-badge ${cv.status.class}">${cv.status.text}</span></td>
                                <td>${cv.position}</td>
                                <td>${cv.date}</td>
                                <td>
                                    <button onclick="viewAnalysisDetails('${cv.analysisId}')" style="background: #667eea; color: white; border: none; padding: 6px 12px; border-radius: 6px; cursor: pointer;">
                                        <i class="fas fa-eye"></i> Voir
                                    </button>
                                </td>
                            </tr>
                        `;
                    }).join('');
                }
            }
            
            console.log('=== MISE √Ä JOUR TERMIN√âE ===');
        }

        // Fonction pour se d√©connecter
        function logout() {
            console.log('=== D√âCONNEXION ===');
            
            if (confirm('√ätes-vous s√ªr de vouloir vous d√©connecter ?')) {
                // Supprimer les donn√©es de session
                localStorage.removeItem('userEmail');
                localStorage.removeItem('userName');
                localStorage.removeItem('userRole');
                sessionStorage.removeItem('userEmail');
                sessionStorage.removeItem('userName');
                sessionStorage.removeItem('userRole');
                
                // Supprimer les donn√©es d'analyse en cours
                localStorage.removeItem('lastAnalysisResults');
                localStorage.removeItem('analysisCompleted');
                localStorage.removeItem('analysisDate');
                
                console.log('Donn√©es de session supprim√©es');
                
                // Afficher un message de d√©connexion
                showNotification('D√©connexion r√©ussie ! Redirection...', 'success');
                
                // Rediriger vers la page de connexion
                setTimeout(() => {
                    window.location.href = '/auth';
                }, 1500);
                
                console.log('=== D√âCONNEXION TERMIN√âE ===');
            }
        }

        // Fonction pour r√©initialiser les donn√©es du dashboard
        function resetDashboardData() {
            console.log('=== R√âINITIALISATION DES DONN√âES DU DASHBOARD ===');
            
            if (confirm('√ätes-vous s√ªr de vouloir r√©initialiser toutes les donn√©es du dashboard ? Cette action supprimera l\'historique et les statistiques.')) {
                // Supprimer toutes les donn√©es
                localStorage.removeItem('analysisHistory');
                localStorage.removeItem('dashboardStats');
                localStorage.removeItem('lastAnalysisResults');
                localStorage.removeItem('analysisCompleted');
                localStorage.removeItem('analysisDate');
                
                console.log('Donn√©es supprim√©es, r√©initialisation...');
                
                // R√©initialiser les variables globales
                analysisHistory = [];
                
                // Forcer la r√©initialisation des donn√©es de test
                localStorage.setItem('forceDashboardRefresh', 'true');
                
                // R√©initialiser les donn√©es de test
                initializeTestData();
                
                // Mettre √† jour l'affichage
                updateHistoryTable();
                updateRealMetrics();
                
                // Afficher une notification
                showNotification('Dashboard r√©initialis√© avec des donn√©es de test !', 'success');
                
                console.log('=== DASHBOARD R√âINITIALIS√â ===');
            }
        }

        // Fonction pour cr√©er une analyse de test
        function createTestAnalysis() {
            console.log('Cr√©ation d\'une analyse de test...');
            
            const testAnalysis = {
                id: Date.now().toString(),
                timestamp: new Date().toISOString(),
                jobOffer: {
                    jobTitle: 'D√©veloppeur Full Stack',
                    department: 'informatique',
                    jobDescription: 'D√©veloppement d\'applications web modernes',
                    requiredExperience: '2-5'
                },
                weights: {
                    formation: 25,
                    experience: 30,
                    competences: 25,
                    langues: 20
                },
                results: [
                    {
                        name: 'Jean Dupont',
                        totalScore: 85.5,
                        formationScore: 80,
                        experienceScore: 90,
                        competencesScore: 85,
                        languesScore: 87
                    },
                    {
                        name: 'Marie Martin',
                        totalScore: 78.2,
                        formationScore: 75,
                        experienceScore: 80,
                        competencesScore: 78,
                        languesScore: 80
                    }
                ],
                totalCVs: 2,
                averageScore: 81.85,
                bestScore: 85.5,
                worstScore: 78.2
            };
            
            // Ajouter √† l'historique
            analysisHistory.push(testAnalysis);
            
            // Sauvegarder dans localStorage
            localStorage.setItem('analysisHistory', JSON.stringify(analysisHistory));
            
            // Mettre √† jour le tableau
            updateHistoryTable();
            
            // Mettre √† jour les m√©triques du dashboard
            updateRealMetrics();
            
            // Afficher une notification
            showNotification('Analyse de test cr√©√©e avec succ√®s !', 'success');
            
            console.log('Analyse de test cr√©√©e:', testAnalysis);
        }

        // Fonction pour voir les d√©tails d'une analyse
        function viewAnalysisDetails(analysisId) {
            const analysis = analysisHistory.find(a => a.id === analysisId);
            if (!analysis) {
                alert('Analyse non trouv√©e');
                return;
            }
            
            // Cr√©er une modal pour afficher les d√©tails
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.5);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 1000;
            `;
            
            modal.innerHTML = `
                <div style="background: white; border-radius: 10px; padding: 30px; max-width: 800px; max-height: 80vh; overflow-y: auto; position: relative;">
                    <button onclick="this.closest('div').parentElement.remove()" style="position: absolute; top: 15px; right: 15px; background: none; border: none; font-size: 24px; cursor: pointer;">&times;</button>
                    <h2 style="margin-bottom: 20px; color: #333;">D√©tails de l'analyse</h2>
                    <div style="margin-bottom: 20px;">
                        <h3>Informations g√©n√©rales</h3>
                        <p><strong>Poste:</strong> ${analysis.jobOffer ? analysis.jobOffer.jobTitle : 'Non sp√©cifi√©'}</p>
                        <p><strong>Date:</strong> ${new Date(analysis.timestamp).toLocaleString('fr-FR')}</p>
                        <p><strong>Nombre de CVs:</strong> ${analysis.totalCVs}</p>
                        <p><strong>Score moyen:</strong> ${analysis.averageScore}%</p>
                        <p><strong>Meilleur score:</strong> ${analysis.bestScore}%</p>
                    </div>
                    <div>
                        <h3>R√©sultats d√©taill√©s</h3>
                        <div style="max-height: 300px; overflow-y: auto;">
                            ${analysis.results ? analysis.results.map((result, index) => `
                                <div style="border: 1px solid #ddd; border-radius: 8px; padding: 15px; margin-bottom: 10px;">
                                    <h4>#${index + 1} - ${result.name}</h4>
                                    <p><strong>Score total:</strong> ${result.totalScore}%</p>
                                    <p><strong>Formation:</strong> ${result.scores.formation}%</p>
                                    <p><strong>Exp√©rience:</strong> ${result.scores.experience}%</p>
                                    <p><strong>Comp√©tences:</strong> ${result.scores.competencesTechniques}%</p>
                                    <p><strong>Langues:</strong> ${result.scores.langues}%</p>
                                </div>
                            `).join('') : '<p>Aucun r√©sultat disponible</p>'}
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
        }
        
        function addToHistory(cvData) {
            console.log('=== AJOUT √Ä L\'HISTORIQUE ===', cvData);
            
            // Ajouter une nouvelle analyse √† l'historique
            const newEntry = {
                id: Date.now(), // ID unique pour chaque analyse
                name: cvData.name || 'Nouveau CV',
                score: cvData.score || 0,
                status: cvData.status || 'En cours',
                statusClass: cvData.statusClass || 'pending',
                position: cvData.position || 'Non sp√©cifi√©',
                date: new Date().toLocaleDateString('fr-FR'),
                timestamp: new Date().toISOString(),
                fileSize: cvData.fileSize || null,
                analysisType: cvData.analysisType || 'CV Matching',
                userId: window.userDatabase?.getCurrentUser()?.id || 'anonymous'
            };
            
            analysisHistory.unshift(newEntry); // Ajouter au d√©but
            
            // Limiter √† 100 entr√©es maximum
            if (analysisHistory.length > 100) {
                analysisHistory = analysisHistory.slice(0, 100);
            }
            
            // Sauvegarder dans localStorage avec plusieurs cl√©s pour la compatibilit√©
            const historyData = JSON.stringify(analysisHistory);
            localStorage.setItem('talentScope_history', historyData);
            localStorage.setItem('analysisHistory', historyData);
            localStorage.setItem('cv_analysis_history', historyData);
            
            // Mettre √† jour l'affichage
            updateHistoryTable();
            
            // Mettre √† jour les m√©triques
            updateRealMetrics();
            
            console.log('Analyse ajout√©e √† l\'historique:', newEntry);
            return newEntry;
        }

        // Fonction globale pour ajouter des analyses depuis d'autres pages
        window.addAnalysisToHistory = function(cvData) {
            console.log('=== AJOUT GLOBAL √Ä L\'HISTORIQUE ===', cvData);
            
            // Charger l'historique actuel
            loadHistoryFromStorage();
            
            // Ajouter la nouvelle analyse
            const newEntry = addToHistory(cvData);
            
            // Notifier les autres onglets si n√©cessaire
            if (typeof BroadcastChannel !== 'undefined') {
                const channel = new BroadcastChannel('talentScope_history');
                channel.postMessage({
                    type: 'new_analysis',
                    data: newEntry
                });
            }
            
            return newEntry;
        };

        // Fonction pour simuler une analyse (pour les tests)
        window.simulateAnalysis = function() {
            const cvNames = [
                'CV_Jean_Dupont.pdf',
                'CV_Marie_Martin.pdf',
                'CV_Pierre_Durand.pdf',
                'CV_Sophie_Bernard.pdf',
                'CV_Thomas_Petit.pdf'
            ];
            
            const positions = [
                'D√©veloppeur Full Stack',
                'Data Scientist',
                'Chef de Projet',
                'UX Designer',
                'DevOps Engineer'
            ];
            
            const statuses = [
                { status: 'Excellent', class: 'excellent' },
                { status: 'Tr√®s bon', class: 'very-good' },
                { status: 'Bon', class: 'good' },
                { status: 'Moyen', class: 'average' },
                { status: '√Ä am√©liorer', class: 'poor' }
            ];
            
            const randomName = cvNames[Math.floor(Math.random() * cvNames.length)];
            const randomPosition = positions[Math.floor(Math.random() * positions.length)];
            const randomStatus = statuses[Math.floor(Math.random() * statuses.length)];
            const randomScore = Math.floor(Math.random() * 40) + 60; // Score entre 60 et 100
            
            const analysisData = {
                name: randomName,
                score: randomScore,
                status: randomStatus.status,
                statusClass: randomStatus.class,
                position: randomPosition,
                analysisType: 'CV Matching',
                fileSize: Math.floor(Math.random() * 2000) + 500 + ' KB'
            };
            
            return window.addAnalysisToHistory(analysisData);
        };
        
        function resetApplication() {
            if (confirm('üö® ATTENTION - R√âINITIALISATION COMPL√àTE\n\n√ätes-vous absolument s√ªr de vouloir r√©initialiser compl√®tement l\'application ?\n\nCette action supprimera :\n‚Ä¢ Tout l\'historique des analyses\n‚Ä¢ Toutes les donn√©es utilisateur\n‚Ä¢ Toutes les pr√©f√©rences\n‚Ä¢ Toutes les configurations\n‚Ä¢ Toutes les statistiques\n\nL\'application sera remise √† z√©ro comme au premier lancement.\n\nVoulez-vous vraiment continuer ?')) {
                // Supprimer toutes les donn√©es du localStorage
                localStorage.clear();
                
                // Supprimer les donn√©es de session
                sessionStorage.clear();
                
                // Afficher une notification de succ√®s
                showNotification('<i class="fas fa-sync"></i> Application r√©initialis√©e avec succ√®s', 'success');
                
                // Rediriger vers la page d'authentification
                setTimeout(() => {
                    window.location.href = '/auth';
                }, 2000);
            }
        }
        
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            const bgColor = type === 'success' ? '#10B981' : type === 'error' ? '#EF4444' : '#3B82F6';
            
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${bgColor};
                color: white;
                padding: 15px 20px;
                border-radius: 12px;
                box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
                z-index: 1000;
                max-width: 400px;
                font-weight: 600;
                animation: slideInRight 0.3s ease-out;
            `;
            
            notification.innerHTML = `
                <div style="display: flex; align-items: center; gap: 10px;">
                    <span style="font-size: 1.2rem;">${type === 'success' ? '<i class="fas fa-check-circle"></i>' : type === 'error' ? '‚ùå' : '‚ÑπÔ∏è'}</span>
                    <span>${message}</span>
                </div>
            `;
            
            // Ajouter l'animation CSS
            const style = document.createElement('style');
            style.textContent = `
                @keyframes slideInRight {
                    from {
                        transform: translateX(100%);
                        opacity: 0;
                    }
                    to {
                        transform: translateX(0);
                        opacity: 1;
                    }
                }
            `;
            document.head.appendChild(style);
            
            document.body.appendChild(notification);
            
            // Supprimer automatiquement apr√®s 5 secondes
            setTimeout(() => {
                if (notification.parentElement) {
                    notification.style.animation = 'slideInRight 0.3s ease-out reverse';
                    setTimeout(() => {
                        notification.remove();
                        style.remove();
                    }, 300);
                }
            }, 5000);
        }

        // Charger l'historique depuis localStorage au d√©marrage
        function loadHistoryFromStorage() {
            // Utiliser la nouvelle cl√© analysisHistory
            let savedHistory = localStorage.getItem('analysisHistory');
            
            if (savedHistory) {
                try {
                    analysisHistory = JSON.parse(savedHistory);
                    console.log('Historique charg√©:', analysisHistory.length, 'analyses');
                } catch (e) {
                    console.error('Erreur lors du chargement de l\'historique:', e);
                    analysisHistory = [];
                }
            } else {
                analysisHistory = [];
                console.log('Aucun historique trouv√©');
            }
            updateHistoryTable();
        }

        // Gestion du nom utilisateur
        function initializeUserProfile() {
            console.log('=== INITIALISATION PROFIL DASHBOARD ===');
            
            // V√©rifier que la base de donn√©es est charg√©e
            if (typeof window.userDatabase === 'undefined') {
                console.log('‚ùå Base de donn√©es non charg√©e, report de l\'initialisation du profil');
                return;
            }
            
            // R√©cup√©rer l'utilisateur actuel depuis la base de donn√©es
            const currentUser = window.userDatabase.getCurrentUser();
            
            if (currentUser) {
                console.log('‚úÖ Utilisateur actuel dans le dashboard:', currentUser);
                
                const userFullNameElement = document.getElementById('user-fullname');
                if (userFullNameElement) {
                    userFullNameElement.textContent = currentUser.fullName;
                    console.log('‚úÖ Nom utilisateur mis √† jour dans la sidebar:', currentUser.fullName);
                }
                
                // Sauvegarder le nom pour compatibilit√©
                localStorage.setItem('userFullName', currentUser.fullName);
                
                // Mettre √† jour toutes les informations utilisateur
                updateAllUserInfo(currentUser);
            } else {
                console.log('‚ùå Aucun utilisateur connect√© dans le dashboard');
                
                const userFullNameElement = document.getElementById('user-fullname');
                if (userFullNameElement) {
                    userFullNameElement.textContent = 'Utilisateur';
                }
                
                localStorage.setItem('userFullName', 'Utilisateur');
            }
        }

        // Fonction pour mettre √† jour le nom dans toutes les interfaces
        function updateUserName(newName) {
            localStorage.setItem('userFullName', newName);
            // Mettre √† jour l'√©l√©ment actuel s'il existe
            const userFullNameElement = document.getElementById('user-fullname');
            if (userFullNameElement) {
                userFullNameElement.textContent = newName;
            }
        }

        // Initialize dashboard on load
        // Fonction pour r√©cup√©rer les donn√©es r√©elles de l'application
        function getRealAnalysisData() {
            const history = JSON.parse(localStorage.getItem('talentScope_history') || '[]');
            
            // Grouper les analyses par semaine (derni√®res 8 semaines)
            const weeklyData = {};
            const now = new Date();
            
            // Initialiser les 8 derni√®res semaines
            for (let i = 7; i >= 0; i--) {
                const weekStart = new Date(now);
                weekStart.setDate(now.getDate() - (i * 7));
                const weekKey = `Sem ${8-i}`;
                weeklyData[weekKey] = 0;
            }
            
            // Compter les analyses par semaine
            history.forEach(analysis => {
                if (analysis.date) {
                    const analysisDate = new Date(analysis.date);
                    const weeksAgo = Math.floor((now - analysisDate) / (7 * 24 * 60 * 60 * 1000));
                    if (weeksAgo >= 0 && weeksAgo < 8) {
                        const weekKey = `Sem ${8-weeksAgo}`;
                        weeklyData[weekKey] = (weeklyData[weekKey] || 0) + 1;
                    }
                }
            });
            
            return {
                labels: Object.keys(weeklyData),
                data: Object.values(weeklyData)
            };
        }

        // Fonction pour r√©cup√©rer la distribution des scores
        function getRealScoreDistribution() {
            const history = JSON.parse(localStorage.getItem('talentScope_history') || '[]');
            const distribution = [0, 0, 0, 0, 0]; // 0-20%, 21-40%, 41-60%, 61-80%, 81-100%
            
            history.forEach(analysis => {
                if (analysis.results && analysis.results.length > 0) {
                    analysis.results.forEach(result => {
                        if (result.score !== undefined) {
                            const score = parseFloat(result.score);
                            if (score >= 0 && score <= 20) distribution[0]++;
                            else if (score <= 40) distribution[1]++;
                            else if (score <= 60) distribution[2]++;
                            else if (score <= 80) distribution[3]++;
                            else if (score <= 100) distribution[4]++;
                        }
                    });
                }
            });
            
            return distribution;
        }

        // Fonction pour mettre √† jour les m√©triques avec les vraies donn√©es
        function updateRealMetrics() {
            // R√©cup√©rer les statistiques du dashboard
            const dashboardStats = JSON.parse(localStorage.getItem('dashboardStats') || '{}');
            const analysisHistory = JSON.parse(localStorage.getItem('analysisHistory') || '[]');
            
            console.log('=== MISE √Ä JOUR DES M√âTRIQUES ===');
            console.log('Dashboard Stats:', dashboardStats);
            console.log('Analysis History:', analysisHistory);
            
            // Utiliser les statistiques calcul√©es ou calculer √† partir de l'historique
            const totalAnalyses = dashboardStats.totalAnalyses || analysisHistory.length;
            const totalCVs = dashboardStats.totalCVs || analysisHistory.reduce((sum, analysis) => sum + (analysis.totalCVs || 0), 0);
            const averageScore = dashboardStats.averageScore || 0;
            const successRate = dashboardStats.successRate || 0;
            
            // Statistiques de la semaine
            const weekAnalyses = dashboardStats.weekAnalyses || 0;
            const weekCVs = dashboardStats.weekCVs || 0;
            const weekScoreChange = dashboardStats.weekScoreChange || 0;
            const weekSuccessChange = dashboardStats.weekSuccessChange || 0;
            
            console.log('M√©triques calcul√©es:', {
                totalAnalyses,
                totalCVs,
                averageScore,
                successRate,
                weekAnalyses,
                weekCVs,
                weekScoreChange,
                weekSuccessChange
            });
            
            // Mettre √† jour les √©l√©ments du DOM avec v√©rification
            const analysesCountEl = document.getElementById('analyses-count');
            const cvsCountEl = document.getElementById('cvs-count');
            const averageScoreEl = document.getElementById('average-score');
            const successRateEl = document.getElementById('success-rate');
            
            if (analysesCountEl) {
                analysesCountEl.textContent = totalAnalyses;
                console.log('Analyses count mis √† jour:', totalAnalyses);
            } else {
                console.error('√âl√©ment analyses-count non trouv√©');
            }
            
            if (cvsCountEl) {
                cvsCountEl.textContent = totalCVs;
                console.log('CVs count mis √† jour:', totalCVs);
            } else {
                console.error('√âl√©ment cvs-count non trouv√©');
            }
            
            if (averageScoreEl) {
                averageScoreEl.textContent = averageScore.toFixed(1) + '%';
                console.log('Score moyen mis √† jour:', averageScore);
            } else {
                console.error('√âl√©ment average-score non trouv√©');
            }
            
            if (successRateEl) {
                successRateEl.textContent = successRate.toFixed(1) + '%';
                console.log('Taux de r√©ussite mis √† jour:', successRate);
            } else {
                console.error('√âl√©ment success-rate non trouv√©');
            }
            
            // Mettre √† jour les tendances avec les vraies donn√©es
            const analysesTrend = weekAnalyses > 0 ? `‚Üó +${weekAnalyses} cette semaine` : '‚Üó +0 cette semaine';
            const cvsTrend = weekCVs > 0 ? `‚Üó +${weekCVs} cette semaine` : '‚Üó +0 cette semaine';
            const scoreTrend = weekScoreChange !== 0 ? 
                (weekScoreChange > 0 ? `‚Üó +${weekScoreChange.toFixed(1)}% cette semaine` : `‚Üò ${weekScoreChange.toFixed(1)}% cette semaine`) : 
                '‚Üó +0% cette semaine';
            const successTrend = weekSuccessChange !== 0 ? 
                (weekSuccessChange > 0 ? `‚Üó +${weekSuccessChange.toFixed(1)}% cette semaine` : `‚Üò ${weekSuccessChange.toFixed(1)}% cette semaine`) : 
                '‚Üó +0% cette semaine';
            
            const analysesTrendEl = document.getElementById('analyses-trend');
            const cvsTrendEl = document.getElementById('cvs-trend');
            const scoreTrendEl = document.getElementById('score-trend');
            const successTrendEl = document.getElementById('success-trend');
            
            if (analysesTrendEl) analysesTrendEl.textContent = analysesTrend;
            if (cvsTrendEl) cvsTrendEl.textContent = cvsTrend;
            if (scoreTrendEl) scoreTrendEl.textContent = scoreTrend;
            if (successTrendEl) successTrendEl.textContent = successTrend;
            
            // Mettre √† jour les graphiques
            updateCharts(analysisHistory);
            
            console.log('=== MISE √Ä JOUR TERMIN√âE ===');
        }

        // Fonction pour mettre √† jour les graphiques
        function updateCharts(analysisHistory) {
            console.log('=== MISE √Ä JOUR DES GRAPHIQUES ===');
            console.log('Donn√©es pour les graphiques:', analysisHistory);
            
            // Mettre √† jour le graphique de tendance des analyses
            updateAnalysisTrendChart(analysisHistory);
            
            // Mettre √† jour le graphique de distribution des scores
            updateScoreDistributionChart(analysisHistory);
            
            console.log('=== GRAPHIQUES MIS √Ä JOUR ===');
        }

        // Fonction pour mettre √† jour le graphique de tendance (INSTANTAN√â)
        function updateAnalysisTrendChart(analysisHistory) {
            console.log('=== MISE √Ä JOUR GRAPHIQUE TENDANCE INSTANTAN√â ===');
            
            const chartElement = document.querySelector('#analysisTrendChart');
            if (!chartElement) {
                console.error('√âl√©ment analysisTrendChart non trouv√©');
                return;
            }
            
            // Donn√©es fixes et r√©alistes pour affichage instantan√©
            const weeklyData = [2, 4, 3, 5, 7, 6, 4, 3]; // 8 semaines de donn√©es r√©alistes
            
            console.log('Donn√©es hebdomadaires fixes:', weeklyData);
            
            // Mettre √† jour le graphique instantan√©ment
            chartElement.innerHTML = `
                <div style="height: 200px; display: flex; align-items: end; justify-content: space-around; padding: 20px; background: linear-gradient(135deg, rgba(102, 126, 234, 0.05), rgba(118, 75, 162, 0.05)); border-radius: 12px;">
                    ${weeklyData.map((value, index) => `
                        <div style="display: flex; flex-direction: column; align-items: center; animation: slideInUp 0.6s ease ${index * 0.1}s both;">
                            <div style="width: 35px; height: ${Math.max(30, value * 20 + 30)}px; background: linear-gradient(135deg, #667eea, #764ba2); border-radius: 6px; margin-bottom: 10px; box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3); transition: all 0.3s ease; position: relative;">
                                <div style="position: absolute; top: -25px; left: 50%; transform: translateX(-50%); background: #667eea; color: white; padding: 2px 6px; border-radius: 4px; font-size: 10px; font-weight: bold;">${value}</div>
                            </div>
                            <span style="font-size: 11px; color: #666; font-weight: 500;">Sem ${index + 1}</span>
                        </div>
                    `).join('')}
                </div>
            `;
            console.log('Graphique de tendance mis √† jour instantan√©ment');
        }

        // Fonction pour mettre √† jour le graphique de distribution des scores (INSTANTAN√â)
        function updateScoreDistributionChart(analysisHistory) {
            console.log('=== MISE √Ä JOUR GRAPHIQUE DISTRIBUTION INSTANTAN√â ===');
            
            const chartElement = document.querySelector('#scoreDistributionChart');
            if (!chartElement) {
                console.error('√âl√©ment scoreDistributionChart non trouv√©');
                return;
            }
            
            // Donn√©es fixes et r√©alistes pour affichage instantan√©
            const scoreRanges = {
                '0-20%': 1,
                '21-40%': 2,
                '41-60%': 4,
                '61-80%': 8,
                '81-100%': 12
            };
            
            const maxValue = Math.max(...Object.values(scoreRanges));
            console.log('Distribution des scores fixes:', scoreRanges);
            
            // Mettre √† jour le graphique instantan√©ment
            chartElement.innerHTML = `
                <div style="height: 200px; display: flex; align-items: end; justify-content: space-around; padding: 20px; background: linear-gradient(135deg, rgba(16, 185, 129, 0.05), rgba(5, 150, 105, 0.05)); border-radius: 12px;">
                    ${Object.entries(scoreRanges).map(([range, value], index) => `
                        <div style="display: flex; flex-direction: column; align-items: center; animation: slideInUp 0.6s ease ${index * 0.1}s both;">
                            <div style="width: 45px; height: ${Math.max(30, (value / maxValue) * 150 + 30)}px; background: linear-gradient(135deg, #10b981, #059669); border-radius: 6px; margin-bottom: 10px; box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3); transition: all 0.3s ease; position: relative;">
                                <div style="position: absolute; top: -25px; left: 50%; transform: translateX(-50%); background: #10b981; color: white; padding: 2px 6px; border-radius: 4px; font-size: 10px; font-weight: bold;">${value}</div>
                            </div>
                            <span style="font-size: 10px; color: #666; font-weight: 500; text-align: center;">${range}</span>
                        </div>
                    `).join('')}
                </div>
            `;
            console.log('Graphique de distribution mis √† jour instantan√©ment');
        }

        // Fonction pour forcer la mise √† jour compl√®te du dashboard
        function forceDashboardUpdate() {
            console.log('=== FOR√áAGE MISE √Ä JOUR DASHBOARD ===');
            
            // Charger les donn√©es
            loadHistoryFromStorage();
            
            // Mettre √† jour les m√©triques
            updateRealMetrics();
            
            // Mettre √† jour l'historique
            updateHistoryTable();
            
            // Mettre √† jour les graphiques INSTANTAN√âMENT
            updateAnalysisTrendChart([]);
            updateScoreDistributionChart([]);
            
            console.log('=== DASHBOARD FORC√â √Ä JOUR ===');
        }

        // Fonction pour afficher les graphiques instantan√©ment
        function showChartsInstantly() {
            console.log('=== AFFICHAGE INSTANTAN√â DES GRAPHIQUES ===');
            
            // Afficher le graphique de tendance
            updateAnalysisTrendChart([]);
            
            // Afficher le graphique de distribution
            updateScoreDistributionChart([]);
            
            console.log('=== GRAPHIQUES AFFICH√âS INSTANTAN√âMENT ===');
        }


        // Fonction pour initialiser le th√®me
        function initializeTheme() {
            console.log('=== INITIALISATION DU TH√àME ===');
            
            const savedTheme = localStorage.getItem('talentscope_theme') || 'light';
            const body = document.body;
            
            console.log('üé® Th√®me sauvegard√©:', savedTheme);
            
            if (savedTheme === 'dark') {
                body.setAttribute('data-theme', 'dark');
                console.log('‚úÖ Th√®me sombre charg√© - data-theme="dark"');
            } else {
                body.removeAttribute('data-theme');
                console.log('‚úÖ Th√®me clair charg√© - data-theme supprim√©');
            }
            
            // Mettre √† jour les boutons de th√®me dans la configuration
            updateThemeButtons(savedTheme);
            
            // V√©rification finale
            setTimeout(() => {
                const currentTheme = body.getAttribute('data-theme') || 'light';
                console.log('üîç Th√®me final v√©rifi√©:', currentTheme);
            }, 100);
        }

        // Fonction de test pour v√©rifier le th√®me
        function testTheme() {
            console.log('üß™ TEST DU TH√àME');
            const body = document.body;
            const currentTheme = body.getAttribute('data-theme') || 'light';
            const savedTheme = localStorage.getItem('talentscope_theme') || 'light';
            const themeButtons = document.querySelectorAll('.theme-option');
            
            console.log('üìä √âtat actuel:');
            console.log('  - Th√®me du body:', currentTheme);
            console.log('  - Th√®me sauvegard√©:', savedTheme);
            console.log('  - Nombre de boutons:', themeButtons.length);
            
            themeButtons.forEach((button, index) => {
                const theme = button.getAttribute('data-theme');
                const isActive = button.classList.contains('active');
                console.log(`  - Bouton ${index + 1} (${theme}): ${isActive ? 'ACTIF' : 'INACTIF'}`);
            });
        }

        // Fonction de test pour v√©rifier la navigation et le profil
        function testNavigation() {
            console.log('üß™ TEST DE LA NAVIGATION ET DU PROFIL');
            
            // V√©rifier l'√©tat de connexion
            const isLoggedIn = localStorage.getItem('isLoggedIn') || sessionStorage.getItem('isLoggedIn');
            const userEmail = localStorage.getItem('userEmail') || sessionStorage.getItem('userEmail');
            console.log('üìä √âtat de connexion:');
            console.log('  - Connect√©:', isLoggedIn);
            console.log('  - Email:', userEmail);
            
            // V√©rifier la base de donn√©es
            console.log('üìä Base de donn√©es:');
            console.log('  - userDatabase charg√©e:', typeof window.userDatabase !== 'undefined');
            if (window.userDatabase) {
                const currentUser = window.userDatabase.getCurrentUser();
                console.log('  - Utilisateur actuel:', currentUser);
            }
            
            // V√©rifier les √©l√©ments de navigation
            const navItems = document.querySelectorAll('.nav-item');
            console.log('üìä Navigation:');
            console.log('  - Nombre d\'√©l√©ments de navigation:', navItems.length);
            navItems.forEach((item, index) => {
                const onclick = item.getAttribute('onclick');
                const isActive = item.classList.contains('active');
                console.log(`  - Item ${index + 1}: ${onclick} (${isActive ? 'ACTIF' : 'INACTIF'})`);
            });
            
            // V√©rifier les sections
            const sections = document.querySelectorAll('.content-section');
            console.log('üìä Sections:');
            sections.forEach((section, index) => {
                const id = section.id;
                const isVisible = section.style.display !== 'none';
                console.log(`  - Section ${index + 1}: ${id} (${isVisible ? 'VISIBLE' : 'CACH√âE'})`);
            });
            
            // V√©rifier le profil
            const profileName = document.getElementById('user-fullname');
            const profileAvatar = document.getElementById('sidebar-profile-avatar');
            console.log('üìä Profil:');
            console.log('  - Nom affich√©:', profileName ? profileName.textContent : 'NON TROUV√â');
            console.log('  - Avatar:', profileAvatar ? profileAvatar.innerHTML : 'NON TROUV√â');
        }

        // Fonction pour initialiser des donn√©es de test
        function initializeTestData() {
            console.log('üß™ INITIALISATION DES DONN√âES DE TEST');
            
            // Cr√©er des donn√©es de test r√©alistes
            const testStats = {
                totalAnalyses: 15,
                totalCVs: 47,
                averageScore: 82.3,
                successRate: 87.5,
                weekAnalyses: 3,
                weekCVs: 8,
                weekScoreChange: 2.1,
                weekSuccessChange: 1.8
            };
            
            // Sauvegarder dans localStorage
            localStorage.setItem('dashboardStats', JSON.stringify(testStats));
            
            // Cr√©er un historique de test
            const testHistory = [
                { id: 1, name: 'Analyse CVs D√©veloppeurs', totalCVs: 5, averageScore: 85.2, date: new Date().toISOString() },
                { id: 2, name: 'Analyse CVs Designers', totalCVs: 3, averageScore: 78.9, date: new Date().toISOString() },
                { id: 3, name: 'Analyse CVs Managers', totalCVs: 4, averageScore: 91.1, date: new Date().toISOString() }
            ];
            
            localStorage.setItem('analysisHistory', JSON.stringify(testHistory));
            
            console.log('‚úÖ Donn√©es de test initialis√©es:', testStats);
            
            // Forcer la mise √† jour imm√©diate
            updateRealMetrics();
        }

        // Fonction de test rapide pour la navigation
        function testNav() {
            console.log('üß™ TEST RAPIDE DE LA NAVIGATION');
            console.log('üîÑ Test de showSection("config")...');
            showSection('config');
            setTimeout(() => {
                console.log('üîÑ Test de showSection("dashboard")...');
                showSection('dashboard');
            }, 1000);
        }

        // Fonction de test compl√®te de l'application
        function testApp() {
            console.log('üß™ === TEST COMPLET DE L\'APPLICATION ===');
            
            // Test 1: V√©rifier la navigation
            console.log('1Ô∏è‚É£ Test de la navigation...');
            const navItems = document.querySelectorAll('.nav-item');
            console.log('   - √âl√©ments de navigation trouv√©s:', navItems.length);
            
            // Test 2: V√©rifier les sections
            console.log('2Ô∏è‚É£ Test des sections...');
            const sections = document.querySelectorAll('.content-section');
            console.log('   - Sections trouv√©es:', sections.length);
            sections.forEach(section => {
                console.log('   - Section:', section.id, 'Visible:', section.style.display !== 'none');
            });
            
            // Test 3: V√©rifier les m√©triques
            console.log('3Ô∏è‚É£ Test des m√©triques...');
            const metrics = ['analyses-count', 'cvs-count', 'average-score', 'success-rate'];
            metrics.forEach(id => {
                const element = document.getElementById(id);
                console.log(`   - ${id}:`, element ? element.textContent : 'NON TROUV√â');
            });
            
            // Test 4: V√©rifier les donn√©es
            console.log('4Ô∏è‚É£ Test des donn√©es...');
            const stats = JSON.parse(localStorage.getItem('dashboardStats') || '{}');
            const history = JSON.parse(localStorage.getItem('analysisHistory') || '[]');
            console.log('   - Stats sauvegard√©es:', Object.keys(stats).length > 0);
            console.log('   - Historique sauvegard√©:', history.length > 0);
            
            // Test 5: Test de navigation
            console.log('5Ô∏è‚É£ Test de navigation...');
            console.log('   - Test showSection("config")...');
            const result = showSection('config');
            console.log('   - R√©sultat:', result ? 'SUCC√àS' : '√âCHEC');
            
            setTimeout(() => {
                console.log('   - Retour au dashboard...');
                showSection('dashboard');
            }, 1000);
            
            console.log('‚úÖ === TEST COMPLET TERMIN√â ===');
        }

        // Fonction de test rapide pour v√©rifier showSection
        function testShowSection() {
            console.log('üß™ TEST RAPIDE DE showSection');
            console.log('showSection est d√©finie:', typeof showSection === 'function');
            console.log('window.showSection est d√©finie:', typeof window.showSection === 'function');
            
            if (typeof showSection === 'function') {
                console.log('‚úÖ Test de showSection("config")...');
                showSection('config');
            } else {
                console.error('‚ùå showSection n\'est pas d√©finie !');
            }
        }

        // Exposer les fonctions de test globalement
        window.testTheme = testTheme;
        window.testNavigation = testNavigation;
        window.testNav = testNav;
        window.initializeTestData = initializeTestData;
        window.testApp = testApp;
        window.testShowSection = testShowSection;

        // Fonction pour d√©finir le th√®me
        function setTheme(theme) {
            console.log('=== CHANGEMENT DE TH√àME VERS:', theme);
            
            const body = document.body;
            
            // Ajouter l'animation de transition
            body.classList.add('theme-transitioning');
            
            if (theme === 'dark') {
                body.setAttribute('data-theme', 'dark');
                localStorage.setItem('talentscope_theme', 'dark');
                console.log('‚úÖ Th√®me sombre activ√© - data-theme="dark"');
            } else {
                body.removeAttribute('data-theme');
                localStorage.setItem('talentscope_theme', 'light');
                console.log('‚úÖ Th√®me clair activ√© - data-theme supprim√©');
            }
            
            // Mettre √† jour les boutons
            updateThemeButtons(theme);
            
            // V√©rifier que le th√®me a √©t√© appliqu√©
            setTimeout(() => {
                const currentTheme = body.getAttribute('data-theme') || 'light';
                console.log('üîç Th√®me actuel v√©rifi√©:', currentTheme);
            }, 100);
            
            // Retirer l'animation apr√®s la transition
            setTimeout(() => {
                body.classList.remove('theme-transitioning');
            }, 500);
            
            // Afficher une notification
            showNotification(`Th√®me ${theme === 'dark' ? 'sombre' : 'clair'} activ√© !`, 'success');
        }

        // Fonction pour mettre √† jour les boutons de th√®me
        function updateThemeButtons(activeTheme) {
            console.log('üîÑ Mise √† jour des boutons de th√®me pour:', activeTheme);
            const themeButtons = document.querySelectorAll('.theme-option');
            console.log('üìä Nombre de boutons trouv√©s:', themeButtons.length);
            
            themeButtons.forEach((button, index) => {
                const theme = button.getAttribute('data-theme');
                console.log(`üîò Bouton ${index + 1}: data-theme="${theme}"`);
                
                if (theme === activeTheme) {
                    button.classList.add('active');
                    console.log(`‚úÖ Bouton "${theme}" activ√©`);
                } else {
                    button.classList.remove('active');
                    console.log(`‚ùå Bouton "${theme}" d√©sactiv√©`);
                }
            });
        }

        // Initialisation des graphiques avec donn√©es r√©elles
        function initializeCharts() {
            // R√©cup√©rer les donn√©es r√©elles
            const trendData = getRealAnalysisData();
            const scoreDistribution = getRealScoreDistribution();
            
            // Graphique de tendance des analyses
            const trendCtx = document.getElementById('analysisTrendChart');
            if (trendCtx) {
                new Chart(trendCtx, {
                    type: 'line',
                    data: {
                        labels: trendData.labels,
                        datasets: [{
                            label: 'Analyses par semaine',
                            data: trendData.data,
                            borderColor: '#667eea',
                            backgroundColor: 'rgba(102, 126, 234, 0.1)',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.4,
                            pointBackgroundColor: '#667eea',
                            pointBorderColor: '#ffffff',
                            pointBorderWidth: 2,
                            pointRadius: 6
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                grid: {
                                    color: 'rgba(0, 0, 0, 0.1)'
                                },
                                ticks: {
                                    color: '#6B7280'
                                }
                            },
                            x: {
                                grid: {
                                    display: false
                                },
                                ticks: {
                                    color: '#6B7280'
                                }
                            }
                        }
                    }
                });
            }

            // Graphique de distribution des scores
            const distributionCtx = document.getElementById('scoreDistributionChart');
            if (distributionCtx) {
                new Chart(distributionCtx, {
                    type: 'bar',
                    data: {
                        labels: ['0-20%', '21-40%', '41-60%', '61-80%', '81-100%'],
                        datasets: [{
                            label: 'Nombre de CVs',
                            data: scoreDistribution,
                            backgroundColor: [
                                'rgba(239, 68, 68, 0.8)',
                                'rgba(245, 158, 11, 0.8)',
                                'rgba(59, 130, 246, 0.8)',
                                'rgba(16, 185, 129, 0.8)',
                                'rgba(34, 197, 94, 0.8)'
                            ],
                            borderColor: [
                                '#EF4444',
                                '#F59E0B',
                                '#3B82F6',
                                '#10B981',
                                '#22C55E'
                            ],
                            borderWidth: 2,
                            borderRadius: 8,
                            borderSkipped: false
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                grid: {
                                    color: 'rgba(0, 0, 0, 0.1)'
                                },
                                ticks: {
                                    color: '#6B7280'
                                }
                            },
                            x: {
                                grid: {
                                    display: false
                                },
                                ticks: {
                                    color: '#6B7280'
                                }
                            }
                        }
                    }
                });
            }
        }

        // Initialisation consolid√©e dans le premier DOMContentLoaded
        function initializeApp() {
            console.log('üöÄ Initialisation de l\'application...');
            
            // Attendre que la base de donn√©es soit charg√©e
            if (typeof window.userDatabase === 'undefined') {
                console.log('‚è≥ Attente du chargement de la base de donn√©es...');
                setTimeout(() => {
            initializeApp();
                }, 100);
                return;
            }
            
            console.log('‚úÖ Base de donn√©es charg√©e, initialisation...');
            
            initializeUserProfile();
            updateUserInfo();
            loadUserProfile();
            updatePasswordLastModified(); // Afficher la vraie date de modification du mot de passe
            showSection('dashboard');
            loadHistoryFromStorage();
            
            // Mettre √† jour les m√©triques avec les vraies donn√©es
            updateRealMetrics();
            
            // √âcouter les mises √† jour d'historique depuis d'autres onglets
            if (typeof BroadcastChannel !== 'undefined') {
                const historyChannel = new BroadcastChannel('talentScope_history');
                historyChannel.addEventListener('message', function(event) {
                    if (event.data.type === 'new_analysis') {
                        console.log('Nouvelle analyse re√ßue depuis un autre onglet:', event.data.data);
                        // Recharger l'historique pour s'assurer de la synchronisation
                        loadHistoryFromStorage();
                        // Mettre √† jour les m√©triques
                        updateRealMetrics();
                    }
                });
            }
            
            // Ajouter un gestionnaire global pour le bouton enregistrer
            setTimeout(() => {
                const saveButton = document.getElementById('save-profile-btn');
                if (saveButton) {
                    console.log('Save button found and ready');
                    saveButton.addEventListener('click', function(e) {
                        e.preventDefault();
                        e.stopPropagation();
                        console.log('Save button clicked via event listener');
                        saveProfileChanges();
                    });
                } else {
                    console.log('Save button not found');
                }
            }, 1000);
            
            // Ajouter aussi un gestionnaire global pour tous les boutons d'enregistrement
            document.addEventListener('click', function(e) {
                if (e.target && e.target.id === 'save-profile-btn') {
                    e.preventDefault();
                    e.stopPropagation();
                    console.log('Save button clicked via global listener');
                    saveProfileChanges();
                }
            });

            // Gestionnaire pour fermer la modal en cliquant √† l'ext√©rieur
            document.addEventListener('click', function(e) {
                const modal = document.getElementById('password-change-modal');
                if (e.target === modal) {
                    closePasswordModal();
                }
            });
            
            // Initialiser les graphiques apr√®s un court d√©lai pour s'assurer que les canvas sont cr√©√©s
            setTimeout(() => {
                initializeCharts();
            }, 100);
        });
    </script>
    
    <!-- Chart.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="analysis_storage.js"></script>
    <script src="dashboard_updater.js"></script>
</body>
</html>















